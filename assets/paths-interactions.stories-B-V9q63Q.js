import{r as S,R as T}from"./index-RYns6xqu.js";import{c as I}from"./index-Cm1LdsEh.js";import{l as L}from"./lodash-CcdATr5u.js";import{X as b,Y as D,z as Z}from"./utils-2YTZCScs.js";import{P as _,S as w,O as P,a as k}from"./paths-OTZaEske.js";import"./index-CHvE9HB5.js";import{g as A}from"./vectors-BiytCEVh.js";/* empty css              */function V(m,g){const d=g-m.points[0].time;return{...m,points:m.points.map(u=>({...u,time:u.time+d}))}}const z=({enableDragPaths:m,pickingTolerance:g,enableMultiSelection:d,spaceScaleType:u})=>{const[h,v]=S.useState(_),E=S.useMemo(()=>L.keyBy(h,"id"),[h]),[e,s]=S.useState({xOffset:0,yOffset:0,xZoomLevel:b,yZoomLevel:D,selection:null,panTarget:null,hoveredPath:null});return T.createElement("div",{className:"inset-0"},T.createElement(w,{className:I("inset-0 absolute p-0 m-0",e.panTarget&&"cursor-grabbing",e.hoveredPath&&"cursor-pointer"),operationalPoints:P,spaceOrigin:0,spaceScales:P.slice(0,-1).map((a,t)=>({from:a.position,to:P[t+1].position,...u==="linear"?{size:50*e.yZoomLevel}:{coefficient:150/e.yZoomLevel}})),timeOrigin:+new Date("2024/04/02"),timeScale:6e4/e.xZoomLevel,xOffset:e.xOffset,yOffset:e.yOffset,onClick:({event:a})=>{const{hoveredPath:t,selection:l,panTarget:c}=e;if(!c)if(!t)(!d||!a.ctrlKey)&&s(n=>({...n,selection:null}));else if(!l)s({...e,selection:new Set([t.element.pathId])});else if(!d||!a.ctrlKey)s({...e,selection:l.has(t.element.pathId)?null:new Set([t.element.pathId])});else{const n=new Set(l);n.has(t.element.pathId)?n.delete(t.element.pathId):n.add(t.element.pathId),s({...e,selection:n.size?n:null})}},onHoveredChildUpdate:({item:a})=>{s(t=>({...t,hoveredPath:a}))},onPan:({initialPosition:a,position:t,initialData:l,data:c,isPanning:n})=>{const{panTarget:o,hoveredPath:O,selection:y}=e,x=A(a,t);if(!n)s(i=>({...i,panTarget:null}));else if(!o&&m&&O){const i=y!=null&&y.has(O.element.pathId)?y:new Set([O.element.pathId]);s(p=>({...p,selection:i,panTarget:{type:"items",initialTimeOrigins:Array.from(i).reduce((f,r)=>({...f,[r]:E[r].points[0].time}),{})}}))}else if(!o)s(i=>({...i,panTarget:{type:"stage",initialOffset:{x:e.xOffset,y:e.yOffset}}}));else if(o.type==="stage"){const i=o.initialOffset.x+x.x,p=o.initialOffset.y+x.y;s(f=>({...f,xOffset:i,yOffset:p}))}else if(o.type==="items"){const{initialTimeOrigins:i}=o,p=c.time-l.time;v(f=>f.map(r=>i[r.id]?V(r,i[r.id]+p):r))}},onZoom:a=>{s(t=>({...t,...Z(e,a)}))}},h.map(a=>{var t,l,c,n,o;return T.createElement(k,{key:a.id,path:a,color:a.color,pickingTolerance:g,level:((t=e.panTarget)==null?void 0:t.type)==="items"?(l=e.selection)!=null&&l.has(a.id)?1:4:(c=e.selection)!=null&&c.has(a.id)||((n=e.hoveredPath)==null?void 0:n.element.pathId)===a.id?1:(o=e.selection)!=null&&o.size?3:2})})))},B={title:"SpaceTimeChart/Paths interactions",component:z,argTypes:{enableDragPaths:{name:"Enable dragging paths?",defaultValue:!0,control:{type:"boolean"}},enableMultiSelection:{name:"Multi-selection?",defaultValue:!0,control:{type:"boolean"}},spaceScaleType:{name:"Space scaling type",options:["linear","proportional"],defaultValue:"linear",control:{type:"radio"}},pickingTolerance:{name:"Picking tolerance",description:"(in pixels)",defaultValue:5,control:{type:"number",step:1,min:0,max:30}}}},U={name:"Default arguments",args:{enableDragPaths:!0,enableMultiSelection:!0,spaceScaleType:"linear",pickingTolerance:5}},W=["DefaultArgs"];export{U as DefaultArgs,W as __namedExportsOrder,B as default};
