import{R as o,r as f}from"./index-RYns6xqu.js";import{f as U,h as S,W as ee}from"./index.esm-CkK1enDk.js";import{c as T}from"./index-Cm1LdsEh.js";import{a as te,u as ne}from"./useOutsideClick-CtG5jKG-.js";import{I as ae}from"./Input-DeArfgXO.js";/* empty css              */import"./FieldWrapper-sNyiQ-VR.js";import"./InputStatusIcon-BgCZkodG.js";import"./useFocusByTab-DuF17kQm.js";const re="Invalid selectedSlot: If start and end are defined, the start date must be before the end date.",se="Invalid selectableSlot: If start and end are defined, the start date must be before the end date.",ie="selectedSlot must be within selectableSlot",oe="initialDate must be within selectableSlot",ue=e=>/^[0-9/]+$/.test(e);function m(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function W(e){return e.start&&e.end?m(e.start).getTime()<=m(e.end).getTime():!0}function ce(e,t){const r=new Date(t,e,1).getDay();if(r===1)return[];const a=r===0?6:r-1,s=new Date(t,e,0),c=[];for(let i=0;i<a;i++){const u=s.getDate()-i;c.unshift(new Date(s.getFullYear(),s.getMonth(),u))}return c}function de(e,t){const a=(7-new Date(t,e+1,0).getDay())%7;if(a===0)return[];const s=new Date(t,e+1,1),c=[];for(let i=0;i<a;i++){const u=i+1;c.push(new Date(s.getFullYear(),s.getMonth(),u))}return c}function me(e,t){const r=new Date(t,e+1,0).getDate(),a=[];for(let s=1;s<=r;s++)a.push(new Date(t,e,s));return a}function L(e,t){return!e||!t?!1:e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function O(e,t){if(!t)return!0;const n=m(e),r=t.start?m(t.start):void 0,a=t.end?m(t.end):void 0,s=r?n>=r:!0,c=a?n<=a:!0;return s&&c}function le(e,t){const n=[];for(let r=0;r<t;r++){const a=new Date(e);a.setMonth(e.getMonth()+r,1),n.push(new Date(a.getFullYear(),a.getMonth(),1))}return n}function M(e){if(!e)return"";const t=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getFullYear()).slice(-2);return`${t}/${n}/${r}`}function pe(e,t){return!t||(t==null?void 0:t.start)===null?{start:e,end:null}:t.end?{start:e,end:null}:m(e).getTime()===m(t.start).getTime()?void 0:m(e)<m(t.start)?{start:e,end:t.start}:{start:t.start,end:e}}function fe(e){let t="";if(e){const{start:n,end:r}=e;if(L(n,r))t=M(n);else{let a=M(n);n&&r&&n.getFullYear()===r.getFullYear()&&(a=a.slice(0,5)),t=`${a} - ${M(r)}`}}return t}function x({value:e,isRangeMode:t}){return t?fe(e):M(e)}function Y({value:e,isRangeMode:t}){return t?e:e&&{start:e,end:e}}function De(e,t,n){if(e&&!W(e))throw new Error(re);if(t&&!W(t))throw new Error(se);if(e!=null&&e.start&&(e!=null&&e.end)&&(t!=null&&t.start)&&(t!=null&&t.end)&&(m(e.start)<m(t.start)||m(e.end)>m(t.end)))throw new Error(ie);if(n&&(t!=null&&t.start)&&(t!=null&&t.end)&&(m(n)<m(t.start)||m(n)>m(t.end)))throw new Error(oe)}function ge({displayedMonthStartDate:e,selectableSlot:t,selectedSlot:n}){const r=(t==null?void 0:t.start)??new Date;r.setHours(0,0,0,0);const a=e.getFullYear(),s=e.getMonth(),c=me(s,a),i=ce(s,a),u=de(s,a);return{days:[...i,...c,...u],isReferenceDate:d=>m(d).getTime()===m(r).getTime(),buildDayWrapperClassName:d=>{const l=n&&L(d,n.start)||!1,g=n&&L(d,n.end)||!1,h=(n==null?void 0:n.start)&&n.end&&O(d,n)||l||g,E=O(d,t);let v={"inside-selectable-slot":E,"outside-selectable-slot":!E,"current-month":d.getMonth()===s,past:m(d)<m(r)};return n&&(v={...v,start:l,end:g,"within-selected-slot":h}),T("day-wrapper",v)},isDateSelectable:d=>!(!O(d,t)||d.getMonth()!==s)}}const he=["M","T","W","T","F","S","S"],ye=({date:e,isReferenceDate:t,isSelectable:n,dayWrapperClassName:r,onClick:a})=>o.createElement("div",{onClick:()=>{n&&a(e)},className:"day-background"},o.createElement("div",{className:r},o.createElement("span",{className:"day"},e.getDate()),t&&o.createElement("span",{className:"current-date-highlight"}))),z=e=>{const{days:t,isReferenceDate:n,isDateSelectable:r,buildDayWrapperClassName:a}=ge(e),{displayedMonthStartDate:s,onDayClick:c}=e;return o.createElement("div",{className:"calendar-wrapper"},o.createElement("div",{className:"calendar-anatomy"},o.createElement("p",{className:"calendar-month-label"},s.toLocaleString("en-GB",{month:"short"})),o.createElement("div",{className:"calendar-grid-wrapper"},o.createElement("div",{className:"calendar-weekday-labels"},he.map((i,u)=>o.createElement("p",{key:`${i}-${u}`},i))),o.createElement("div",{className:"calendar-days-grid"},t.map(i=>o.createElement(ye,{key:i.getTime(),date:i,isReferenceDate:n(i),isSelectable:r(i),dayWrapperClassName:a(i),onClick:c}))))))};z.__docgenInfo={description:"",methods:[],displayName:"Calendar",props:{selectedSlot:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  start: Date | null;
  end: Date | null;
}`,signature:{properties:[{key:"start",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!0}},{key:"end",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!0}}]}},description:""},selectableSlot:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  start: Date | null;
  end: Date | null;
}`,signature:{properties:[{key:"start",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!0}},{key:"end",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!0}}]}},description:""},displayedMonthStartDate:{required:!0,tsType:{name:"Date"},description:""},onDayClick:{required:!0,tsType:{name:"signature",type:"function",raw:"(date: Date) => void",signature:{arguments:[{type:{name:"Date"},name:"date"}],return:{name:"void"}}},description:""}}};function Ee({initialDate:e,selectedSlot:t,selectableSlot:n,numberOfMonths:r=1}){De(t,n,e);const[a,s]=f.useState(new Date),c=le(a,r),i=a.getFullYear(),u=a.getMonth(),y=new Date(i,u,1),w=new Date(i,u+1,0),D=n===void 0||n.start===null?!0:n.start<y,d=n===void 0||n.end===null?!0:n.end>w,l=D||d,g=()=>{if(D){const E=u===0?11:u-1,v=u===0?i-1:i;s(new Date(v,E,1))}},h=()=>{if(d){const E=u===11?0:u+1,v=u===11?i+1:i;s(new Date(v,E,1))}};return f.useEffect(()=>{s(e??(t==null?void 0:t.start)??(n==null?void 0:n.start)??new Date)},[e,t,n]),{displayedMonthsStartDates:c,showNavigationBtn:l,canGoToPreviousMonth:D,canGoToNextMonth:d,handleGoToPreviousMonth:g,handleGoToNextMonth:h}}const H=({initialDate:e,selectedSlot:t,selectableSlot:n,numberOfMonths:r=1,onDayClick:a,modalPosition:s,calendarPickerRef:c})=>{const{displayedMonthsStartDates:i,showNavigationBtn:u,canGoToNextMonth:y,canGoToPreviousMonth:w,handleGoToNextMonth:D,handleGoToPreviousMonth:d}=Ee({initialDate:e,selectedSlot:t,selectableSlot:n,numberOfMonths:r});return o.createElement("div",{ref:c,className:"calendar-picker",style:s},u&&o.createElement("span",{className:T("calendar-navigation-btn","previous",{disabled:!w}),onClick:d},o.createElement(U,{size:"lg"})),o.createElement("div",{className:T("calendar-list",{"navigation-btn-hidden":!u})},i.map(l=>o.createElement(z,{key:l.getTime(),displayedMonthStartDate:l,selectableSlot:n,selectedSlot:t,onDayClick:a}))),u&&o.createElement("span",{className:T("calendar-navigation-btn","next",{disabled:!y}),onClick:D},o.createElement(S,{size:"lg"})))};H.__docgenInfo={description:"",methods:[],displayName:"CalendarPicker",props:{selectedSlot:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  start: Date | null;
  end: Date | null;
}`,signature:{properties:[{key:"start",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!0}},{key:"end",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!0}}]}},description:""},onDayClick:{required:!0,tsType:{name:"signature",type:"function",raw:"(day: Date) => void",signature:{arguments:[{type:{name:"Date"},name:"day"}],return:{name:"void"}}},description:""},modalPosition:{required:!0,tsType:{name:"signature",type:"object",raw:`{
  top: number;
  left: number;
}`,signature:{properties:[{key:"top",value:{name:"number",required:!0}},{key:"left",value:{name:"number",required:!0}}]}},description:""},calendarPickerRef:{required:!0,tsType:{name:"ReactRefObject",raw:"React.RefObject<HTMLDivElement>",elements:[{name:"HTMLDivElement"}]},description:""},selectableSlot:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  start: Date | null;
  end: Date | null;
}`,signature:{properties:[{key:"start",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!0}},{key:"end",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!0}}]}},description:""},initialDate:{required:!1,tsType:{name:"Date"},description:""},numberOfMonths:{required:!1,tsType:{name:"union",raw:"1 | 2 | 3",elements:[{name:"literal",value:"1"},{name:"literal",value:"2"},{name:"literal",value:"3"}]},description:"",defaultValue:{value:"1",computed:!1}}}};const ve=-24,we=3,Me=/^\d{2}\/\d{2}\/\d{2}$/;function ke(e){const{value:t,isRangeMode:n,selectableSlot:r,errorMessages:a,onDateChange:s}=e,[c,i]=f.useState(!1),[u,y]=f.useState(x(e)),[w,D]=f.useState(Y(e)),[d,l]=f.useState(),g=f.useRef(null),h=f.useRef(null);te(g,p=>{var k,C;h.current&&((C=(k=h.current.parentElement)==null?void 0:k.parentElement)!=null&&C.contains(p.target))||i(!1)});const{calculatePosition:E,modalPosition:v}=ne(h,g,we,ve),K=()=>{n&&i(!0)},X=p=>{if(n){const k=pe(p,t);s(p,k)}else s(p)},Z=p=>{if(n)return;if(y(p),Me.test(p)){const[C,J,Q]=p.split("/").map(Number),P=new Date(Q+2e3,J-1,C);!isNaN(P.getTime())&&O(P,r)&&s?s(P):l({status:"error",message:a==null?void 0:a.invalidDate});return}if(ue(p)&&p.length<8){l(void 0);return}l({status:"error",message:a==null?void 0:a.invalidInput})};return f.useEffect(()=>{c&&E()},[c,E]),f.useEffect(()=>{const p=x(e);p!==u&&y(p),l(void 0),D(Y(e))},[t]),{showPicker:c,inputValue:u,statusWithMessage:d,selectedSlot:w,modalPosition:v,inputRef:h,calendarPickerRef:g,setShowPicker:i,handleDayClick:X,handleInputClick:K,handleInputOnChange:Z}}const _=e=>{const{inputValue:t,statusWithMessage:n,selectedSlot:r,showPicker:a,modalPosition:s,inputRef:c,calendarPickerRef:i,setShowPicker:u,handleDayClick:y,handleInputClick:w,handleInputOnChange:D}=ke(e),{inputFieldWrapperClassname:d,...l}=e.inputProps,{selectableSlot:g}=e;return o.createElement("div",{className:"date-picker"},o.createElement("div",null,o.createElement(ae,{...l,ref:c,value:t,onClick:w,type:"text",trailingContent:{content:o.createElement(ee,null),onClickCallback:()=>u(!a)},inputFieldWrapperClassname:T("date-picker-input",d,{"range-mode":e.isRangeMode}),autoComplete:"off",onChange:h=>D(h.target.value),statusWithMessage:n})),a&&o.createElement("div",{className:"calendar-picker-wrapper"},o.createElement(H,{...e.calendarPickerProps,selectedSlot:r,onDayClick:y,modalPosition:s,calendarPickerRef:i,selectableSlot:g})))};_.__docgenInfo={description:"",methods:[],displayName:"DatePicker"};const N=new Date,A=new Date(N);A.setMonth(A.getMonth()+3);const F=new Date(N);F.setDate(F.getDate()+5);const q={start:N,end:A},Te={start:N,end:F},Ne=e=>{const[t,n]=f.useState(e.value),r=(s,c)=>n(c),a=s=>n(s);return e.isRangeMode?o.createElement(_,{...e,value:t,onDateChange:r}):o.createElement("div",{className:"date-picker-story-wrapper"},o.createElement(_,{...e,value:t,onDateChange:a,errorMessages:{invalidDate:`Please select a valid date between ${M(q.start)} and ${M(q.end)}`,invalidInput:"Please enter a valid date dd/mm/yy"}}))},qe={component:_,decorators:[e=>o.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},o.createElement(e,null))],parameters:{docs:{story:{height:"500px"}}},args:{selectableSlot:q,calendarPickerProps:{numberOfMonths:1},inputProps:{id:"date-picker",label:"Select a date",inputFieldWrapperClassname:"date-picker-input-wrapper"}},render:e=>o.createElement(Ne,{...e}),title:"core/DatePicker",tags:["autodocs"]},I={args:{isRangeMode:!1,value:N}},R={args:{isRangeMode:!0,value:Te}};var G,$,V;I.parameters={...I.parameters,docs:{...(G=I.parameters)==null?void 0:G.docs,source:{originalSource:`{
  args: {
    isRangeMode: false,
    value: now
  }
}`,...(V=($=I.parameters)==null?void 0:$.docs)==null?void 0:V.source}}};var j,B,b;R.parameters={...R.parameters,docs:{...(j=R.parameters)==null?void 0:j.docs,source:{originalSource:`{
  args: {
    isRangeMode: true,
    value: rangeSelectedSlot
  }
}`,...(b=(B=R.parameters)==null?void 0:B.docs)==null?void 0:b.source}}};const We=["Single","Range"];export{R as Range,I as Single,We as __namedExportsOrder,qe as default};
