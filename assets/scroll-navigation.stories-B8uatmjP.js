import{r as T,R as i}from"./index-RYns6xqu.js";import{c as P}from"./index-Cm1LdsEh.js";import{l as p}from"./lodash-CcdATr5u.js";import{X as L,Y as R,z as b}from"./utils-2YTZCScs.js";import{P as O,S as A,O as y,f as D,a as _}from"./paths-OTZaEske.js";import"./index-CHvE9HB5.js";import{g as h}from"./vectors-BiytCEVh.js";/* empty css              */function d(l,n,s,e){const t=(u,g)=>u.x*g.y-u.y*g.x,o=h(n,l),a=h(e,s),c=t(o,a);if(c===0)return!1;const r=h(s,l),f=t(r,a)/c,m=t(r,o)/c;return p.inRange(f,0,1)&&p.inRange(m,0,1)}function C(l,n,s,e){const t=({x:f,y:m})=>p.inRange(f,0,l)&&p.inRange(m,0,n);if(t(s)||t(e))return!0;const o={x:0,y:0},a={x:l,y:0},c={x:0,y:n},r={x:l,y:n};return d(s,e,o,a)||d(s,e,o,c)||d(s,e,c,r)||d(s,e,a,r)}function Z(l,n,s){if(!s.length)return!1;if(s.length===1){const{x:t,y:o}=s[0];return p.inRange(t,0,l)&&p.inRange(o,0,n)}return s.slice(0,-1).map((t,o)=>[t,s[o+1]]).some(([t,o])=>C(l,n,t,o))}const I=p.keyBy(O,"id"),Y=({spaceScaleType:l})=>{const[n,s]=T.useState({xOffset:0,yOffset:0,xZoomLevel:L*3,yZoomLevel:R,selected:null,panTarget:null,hoveredPath:null});return i.createElement("div",{className:"inset-0"},i.createElement(A,{className:P("inset-0 absolute p-0 m-0",n.panTarget&&"cursor-grabbing",n.hoveredPath&&"cursor-pointer"),operationalPoints:y,spaceOrigin:0,spaceScales:y.slice(0,-1).map((e,t)=>({from:e.position,to:y[t+1].position,...l==="linear"?{size:50*n.yZoomLevel}:{coefficient:150/n.yZoomLevel}})),timeOrigin:+new Date("2024/04/02"),timeScale:6e4/n.xZoomLevel,xOffset:n.xOffset,yOffset:n.yOffset,onClick:()=>{const{hoveredPath:e,selected:t,panTarget:o}=n;o||s(a=>({...a,selected:!e||e.element.pathId===t?null:e.element.pathId}))},onHoveredChildUpdate:({item:e})=>{s(t=>({...t,hoveredPath:e}))},onPan:({initialPosition:e,position:t,isPanning:o})=>{const{panTarget:a}=n,c=h(e,t);if(!o)s(r=>({...r,panTarget:null}));else if(!a)s(r=>({...r,panTarget:{type:"stage",initialOffset:{x:r.xOffset,y:r.yOffset}}}));else if(a.type==="stage"){const r=a.initialOffset.x+c.x,f=a.initialOffset.y+c.y;s(m=>({...m,xOffset:r,yOffset:f}))}},onZoom:e=>{e.event.ctrlKey?(s(t=>({...t,...b(t,e)})),e.event.stopPropagation(),e.event.preventDefault()):s(t=>{const o={...t,xOffset:t.xOffset+e.delta*-50};if(t.selected){const{width:a,height:c,getPoint:r,getTime:f,getSpacePixel:m}=e.context,u=I[t.selected],g=u.points.map(r);if(Z(a,c,g)){const x=f(a/2),v=D(u,x),E=m(v),S=1/4;o.yOffset-=(E-c/2)*S}}return o})}},O.map(e=>{var t,o;return i.createElement(_,{key:e.id,path:e,color:e.color,level:((t=n.panTarget)==null?void 0:t.type)==="items"?n.selected===e.id?1:4:n.selected===e.id||((o=n.hoveredPath)==null?void 0:o.element.pathId)===e.id?1:n.selected?3:2})}),i.createElement("div",{style:{position:"absolute",left:10,bottom:40,fontFamily:"sans-serif",userSelect:"none",background:"#ffffffcc"}},i.createElement("div",null,"You can ",i.createElement("strong",null,"pan")," the chart with the mouse."),i.createElement("div",null,"You can ",i.createElement("strong",null,"select")," a path by clicking it."),i.createElement("div",null,"You can ",i.createElement("strong",null,"zoom")," the chart on the mouse using"," ",i.createElement("strong",null,"the wheel + the Ctrl key"),"."),i.createElement("div",null,"You can ",i.createElement("strong",null,"move")," along the time axis with ",i.createElement("strong",null,"the wheel"),". If a path is selected, it should remain on screen as much as possible."))))},M={title:"SpaceTimeChart/Keep a path focused",component:Y,argTypes:{spaceScaleType:{name:"Space scaling type",options:["linear","proportional"],defaultValue:"linear",control:{type:"radio"}}}},W={name:"Default arguments",args:{spaceScaleType:"linear"}},X=["DefaultArgs"];export{W as DefaultArgs,X as __namedExportsOrder,M as default};
