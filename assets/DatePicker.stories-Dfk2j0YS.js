import{R as o,r as g}from"./index-RYns6xqu.js";import{f as z,h as H,W as j}from"./index.esm-CkK1enDk.js";import{c as I}from"./index-Cm1LdsEh.js";import{a as q,u as K}from"./useOutsideClick-DXZiCUGB.js";import{I as X}from"./Input-C-18yi6J.js";/* empty css              */import"./FieldWrapper-9p7Bgq-6.js";import"./InputStatusIcon-VZR2PQlg.js";import"./useFocusByTab-CGFT2N9H.js";const Z="Invalid selectedSlot: If start and end are defined, the start date must be before the end date.",J="Invalid selectableSlot: If start and end are defined, the start date must be before the end date.",Q="selectedSlot must be within selectableSlot",U="initialDate must be within selectableSlot",b=t=>/^[0-9/]+$/.test(t);function m(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate())}function P(t){return t.start&&t.end?m(t.start).getTime()<=m(t.end).getTime():!0}function S(t,e){const r=new Date(e,t,1).getDay();if(r===1)return[];const a=r===0?6:r-1,s=new Date(e,t,0),u=[];for(let i=0;i<a;i++){const c=s.getDate()-i;u.unshift(new Date(s.getFullYear(),s.getMonth(),c))}return u}function tt(t,e){const a=(7-new Date(e,t+1,0).getDay())%7;if(a===0)return[];const s=new Date(e,t+1,1),u=[];for(let i=0;i<a;i++){const c=i+1;u.push(new Date(s.getFullYear(),s.getMonth(),c))}return u}function et(t,e){const r=new Date(e,t+1,0).getDate(),a=[];for(let s=1;s<=r;s++)a.push(new Date(e,t,s));return a}function O(t,e){return!t||!e?!1:t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()}function k(t,e){if(!e)return!0;const n=m(t),r=e.start?m(e.start):void 0,a=e.end?m(e.end):void 0,s=r?n>=r:!0,u=a?n<=a:!0;return s&&u}function nt(t,e){const n=[];for(let r=0;r<e;r++){const a=new Date(t);a.setMonth(t.getMonth()+r,1),n.push(new Date(a.getFullYear(),a.getMonth(),1))}return n}function v(t){if(!t)return"";const e=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getFullYear()).slice(-2);return`${e}/${n}/${r}`}function at(t,e){return!e||(e==null?void 0:e.start)===null?{start:t,end:null}:e.end?{start:t,end:null}:m(t).getTime()===m(e.start).getTime()?void 0:m(t)<m(e.start)?{start:t,end:e.start}:{start:e.start,end:t}}function rt(t){let e="";if(t){const{start:n,end:r}=t;if(O(n,r))e=v(n);else{let a=v(n);n&&r&&n.getFullYear()===r.getFullYear()&&(a=a.slice(0,5)),e=`${a} - ${v(r)}`}}return e}function W({value:t,isRangeMode:e}){return e?rt(t):v(t)}function x({value:t,isRangeMode:e}){return e?t:t&&{start:t,end:t}}function st(t,e,n){if(t&&!P(t))throw new Error(Z);if(e&&!P(e))throw new Error(J);if(t!=null&&t.start&&(t!=null&&t.end)&&(e!=null&&e.start)&&(e!=null&&e.end)&&(m(t.start)<m(e.start)||m(t.end)>m(e.end)))throw new Error(Q);if(n&&(e!=null&&e.start)&&(e!=null&&e.end)&&(m(n)<m(e.start)||m(n)>m(e.end)))throw new Error(U)}function it({displayedMonthStartDate:t,selectableSlot:e,selectedSlot:n}){const r=(e==null?void 0:e.start)??new Date;r.setHours(0,0,0,0);const a=t.getFullYear(),s=t.getMonth(),u=et(s,a),i=S(s,a),c=tt(s,a);return{days:[...i,...u,...c],isReferenceDate:d=>m(d).getTime()===m(r).getTime(),buildDayWrapperClassName:d=>{const f=n&&O(d,n.start)||!1,p=n&&O(d,n.end)||!1,l=(n==null?void 0:n.start)&&n.end&&k(d,n)||f||p,y=k(d,e);let M={"inside-selectable-slot":y,"outside-selectable-slot":!y,"current-month":d.getMonth()===s,past:m(d)<m(r)};return n&&(M={...M,start:f,end:p,"within-selected-slot":l}),I("day-wrapper",M)},isDateSelectable:d=>!(!k(d,e)||d.getMonth()!==s)}}const ot=["M","T","W","T","F","S","S"],ct=({date:t,isReferenceDate:e,isSelectable:n,dayWrapperClassName:r,onClick:a})=>o.createElement("div",{onClick:()=>{n&&a(t)},className:"day-background"},o.createElement("div",{className:r},o.createElement("span",{className:"day"},t.getDate()),e&&o.createElement("span",{className:"current-date-highlight"}))),ut=t=>{const{days:e,isReferenceDate:n,isDateSelectable:r,buildDayWrapperClassName:a}=it(t),{displayedMonthStartDate:s,onDayClick:u}=t;return o.createElement("div",{className:"calendar-wrapper"},o.createElement("div",{className:"calendar-anatomy"},o.createElement("p",{className:"calendar-month-label"},s.toLocaleString("en-GB",{month:"short"})),o.createElement("div",{className:"calendar-grid-wrapper"},o.createElement("div",{className:"calendar-weekday-labels"},ot.map((i,c)=>o.createElement("p",{key:`${i}-${c}`},i))),o.createElement("div",{className:"calendar-days-grid"},e.map(i=>o.createElement(ct,{key:i.getTime(),date:i,isReferenceDate:n(i),isSelectable:r(i),dayWrapperClassName:a(i),onClick:u}))))))};function dt({initialDate:t,selectedSlot:e,selectableSlot:n,numberOfMonths:r=1}){st(e,n,t);const[a,s]=g.useState(new Date),u=nt(a,r),i=a.getFullYear(),c=a.getMonth(),E=new Date(i,c,1),w=new Date(i,c+1,0),D=n===void 0||n.start===null?!0:n.start<E,d=n===void 0||n.end===null?!0:n.end>w,f=D||d,p=()=>{if(D){const y=c===0?11:c-1,M=c===0?i-1:i;s(new Date(M,y,1))}},l=()=>{if(d){const y=c===11?0:c+1,M=c===11?i+1:i;s(new Date(M,y,1))}};return g.useEffect(()=>{s(t??(e==null?void 0:e.start)??(n==null?void 0:n.start)??new Date)},[t,e,n]),{displayedMonthsStartDates:u,showNavigationBtn:f,canGoToPreviousMonth:D,canGoToNextMonth:d,handleGoToPreviousMonth:p,handleGoToNextMonth:l}}const mt=({initialDate:t,selectedSlot:e,selectableSlot:n,numberOfMonths:r=1,onDayClick:a,modalPosition:s,calendarPickerRef:u})=>{const{displayedMonthsStartDates:i,showNavigationBtn:c,canGoToNextMonth:E,canGoToPreviousMonth:w,handleGoToNextMonth:D,handleGoToPreviousMonth:d}=dt({initialDate:t,selectedSlot:e,selectableSlot:n,numberOfMonths:r});return o.createElement("div",{ref:u,className:"calendar-picker",style:s},c&&o.createElement("span",{className:I("calendar-navigation-btn","previous",{disabled:!w}),onClick:d},o.createElement(z,{size:"lg"})),o.createElement("div",{className:I("calendar-list",{"navigation-btn-hidden":!c})},i.map(f=>o.createElement(ut,{key:f.getTime(),displayedMonthStartDate:f,selectableSlot:n,selectedSlot:e,onDayClick:a}))),c&&o.createElement("span",{className:I("calendar-navigation-btn","next",{disabled:!E}),onClick:D},o.createElement(H,{size:"lg"})))},ft=-24,ht=3,gt=/^\d{2}\/\d{2}\/\d{2}$/;function Dt(t){const{value:e,isRangeMode:n,selectableSlot:r,errorMessages:a,onDateChange:s}=t,[u,i]=g.useState(!1),[c,E]=g.useState(W(t)),[w,D]=g.useState(x(t)),[d,f]=g.useState(),p=g.useRef(null),l=g.useRef(null);q(p,h=>{var N,T;l.current&&((T=(N=l.current.parentElement)==null?void 0:N.parentElement)!=null&&T.contains(h.target))||i(!1)});const{calculatePosition:y,modalPosition:M}=K(l,p,ht,ft),Y=()=>{n&&i(!0)},G=h=>{if(n){const N=at(h,e);s(h,N)}else s(h)},$=h=>{if(n)return;if(E(h),gt.test(h)){const[T,V,B]=h.split("/").map(Number),R=new Date(B+2e3,V-1,T);!isNaN(R.getTime())&&k(R,r)&&s?s(R):f({status:"error",message:a==null?void 0:a.invalidDate});return}if(b(h)&&h.length<8){f(void 0);return}f({status:"error",message:a==null?void 0:a.invalidInput})};return g.useEffect(()=>{u&&y()},[u,y]),g.useEffect(()=>{const h=W(t);h!==c&&E(h),f(void 0),D(x(t))},[e]),{showPicker:u,inputValue:c,statusWithMessage:d,selectedSlot:w,modalPosition:M,inputRef:l,calendarPickerRef:p,setShowPicker:i,handleDayClick:G,handleInputClick:Y,handleInputOnChange:$}}const _=t=>{const{inputValue:e,statusWithMessage:n,selectedSlot:r,showPicker:a,modalPosition:s,inputRef:u,calendarPickerRef:i,setShowPicker:c,handleDayClick:E,handleInputClick:w,handleInputOnChange:D}=Dt(t),{inputFieldWrapperClassname:d,...f}=t.inputProps,{selectableSlot:p}=t;return o.createElement("div",{className:"date-picker"},o.createElement("div",null,o.createElement(X,{...f,ref:u,value:e,onClick:w,type:"text",trailingContent:{content:o.createElement(j,null),onClickCallback:()=>c(!a)},inputFieldWrapperClassname:I("date-picker-input",d,{"range-mode":t.isRangeMode}),autoComplete:"off",onChange:l=>D(l.target.value),statusWithMessage:n})),a&&o.createElement("div",{className:"calendar-picker-wrapper"},o.createElement(mt,{...t.calendarPickerProps,selectedSlot:r,onDayClick:E,modalPosition:s,calendarPickerRef:i,selectableSlot:p})))},C=new Date,L=new Date(C);L.setMonth(L.getMonth()+3);const A=new Date(C);A.setDate(A.getDate()+5);const F={start:C,end:L},pt={start:C,end:A},lt=t=>{const[e,n]=g.useState(t.value),r=(s,u)=>n(u),a=s=>n(s);return t.isRangeMode?o.createElement(_,{...t,value:e,onDateChange:r}):o.createElement("div",{className:"date-picker-story-wrapper"},o.createElement(_,{...t,value:e,onDateChange:a,errorMessages:{invalidDate:`Please select a valid date between ${v(F.start)} and ${v(F.end)}`,invalidInput:"Please enter a valid date dd/mm/yy"}}))},kt={component:_,decorators:[t=>o.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},o.createElement(t,null))],parameters:{docs:{story:{height:"500px"}}},args:{selectableSlot:F,calendarPickerProps:{numberOfMonths:1},inputProps:{id:"date-picker",label:"Select a date",inputFieldWrapperClassname:"date-picker-input-wrapper"}},render:t=>o.createElement(lt,{...t}),title:"core/DatePicker",tags:["autodocs"]},Rt={args:{isRangeMode:!1,value:C}},Ot={args:{isRangeMode:!0,value:pt}},_t=["Single","Range"];export{Ot as Range,Rt as Single,_t as __namedExportsOrder,kt as default};
