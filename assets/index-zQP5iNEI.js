const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./maplibre-gl-Dv-UzEPq.js","./index-RYns6xqu.js"])))=>i.map(i=>d[i]);
import{_ as Ht}from"./iframe-CXcauK7T.js";import{r as S,c as Qt,a as Ue,g as Wt}from"./index-RYns6xqu.js";import{r as At}from"./index-BwmuJAIN.js";const V=11102230246251565e-32,I=134217729,Jt=(3+8*V)*V;function Ae(r,e,t,n,i){let o,s,a,l,u=e[0],d=n[0],f=0,g=0;d>u==d>-u?(o=u,u=e[++f]):(o=d,d=n[++g]);let y=0;if(f<r&&g<t)for(d>u==d>-u?(s=u+o,a=o-(s-u),u=e[++f]):(s=d+o,a=o-(s-d),d=n[++g]),o=s,a!==0&&(i[y++]=a);f<r&&g<t;)d>u==d>-u?(s=o+u,l=s-o,a=o-(s-l)+(u-l),u=e[++f]):(s=o+d,l=s-o,a=o-(s-l)+(d-l),d=n[++g]),o=s,a!==0&&(i[y++]=a);for(;f<r;)s=o+u,l=s-o,a=o-(s-l)+(u-l),u=e[++f],o=s,a!==0&&(i[y++]=a);for(;g<t;)s=o+d,l=s-o,a=o-(s-l)+(d-l),d=n[++g],o=s,a!==0&&(i[y++]=a);return(o!==0||y===0)&&(i[y++]=o),y}function Kt(r,e){let t=e[0];for(let n=1;n<r;n++)t+=e[n];return t}function ye(r){return new Float64Array(r)}const jt=(3+16*V)*V,er=(2+12*V)*V,tr=(9+64*V)*V*V,ne=ye(4),je=ye(8),et=ye(12),tt=ye(16),T=ye(4);function rr(r,e,t,n,i,o,s){let a,l,u,d,f,g,y,p,w,M,_,c,h,m,v,x,E,b;const P=r-i,L=t-i,R=e-o,k=n-o;m=P*k,g=I*P,y=g-(g-P),p=P-y,g=I*k,w=g-(g-k),M=k-w,v=p*M-(m-y*w-p*w-y*M),x=R*L,g=I*R,y=g-(g-R),p=R-y,g=I*L,w=g-(g-L),M=L-w,E=p*M-(x-y*w-p*w-y*M),_=v-E,f=v-_,ne[0]=v-(_+f)+(f-E),c=m+_,f=c-m,h=m-(c-f)+(_-f),_=h-x,f=h-_,ne[1]=h-(_+f)+(f-x),b=c+_,f=b-c,ne[2]=c-(b-f)+(_-f),ne[3]=b;let C=Kt(4,ne),A=er*s;if(C>=A||-C>=A||(f=r-P,a=r-(P+f)+(f-i),f=t-L,u=t-(L+f)+(f-i),f=e-R,l=e-(R+f)+(f-o),f=n-k,d=n-(k+f)+(f-o),a===0&&l===0&&u===0&&d===0)||(A=tr*s+Jt*Math.abs(C),C+=P*d+k*a-(R*u+L*l),C>=A||-C>=A))return C;m=a*k,g=I*a,y=g-(g-a),p=a-y,g=I*k,w=g-(g-k),M=k-w,v=p*M-(m-y*w-p*w-y*M),x=l*L,g=I*l,y=g-(g-l),p=l-y,g=I*L,w=g-(g-L),M=L-w,E=p*M-(x-y*w-p*w-y*M),_=v-E,f=v-_,T[0]=v-(_+f)+(f-E),c=m+_,f=c-m,h=m-(c-f)+(_-f),_=h-x,f=h-_,T[1]=h-(_+f)+(f-x),b=c+_,f=b-c,T[2]=c-(b-f)+(_-f),T[3]=b;const K=Ae(4,ne,4,T,je);m=P*d,g=I*P,y=g-(g-P),p=P-y,g=I*d,w=g-(g-d),M=d-w,v=p*M-(m-y*w-p*w-y*M),x=R*u,g=I*R,y=g-(g-R),p=R-y,g=I*u,w=g-(g-u),M=u-w,E=p*M-(x-y*w-p*w-y*M),_=v-E,f=v-_,T[0]=v-(_+f)+(f-E),c=m+_,f=c-m,h=m-(c-f)+(_-f),_=h-x,f=h-_,T[1]=h-(_+f)+(f-x),b=c+_,f=b-c,T[2]=c-(b-f)+(_-f),T[3]=b;const U=Ae(K,je,4,T,et);m=a*d,g=I*a,y=g-(g-a),p=a-y,g=I*d,w=g-(g-d),M=d-w,v=p*M-(m-y*w-p*w-y*M),x=l*u,g=I*l,y=g-(g-l),p=l-y,g=I*u,w=g-(g-u),M=u-w,E=p*M-(x-y*w-p*w-y*M),_=v-E,f=v-_,T[0]=v-(_+f)+(f-E),c=m+_,f=c-m,h=m-(c-f)+(_-f),_=h-x,f=h-_,T[1]=h-(_+f)+(f-x),b=c+_,f=b-c,T[2]=c-(b-f)+(_-f),T[3]=b;const Z=Ae(U,et,4,T,tt);return tt[Z-1]}function nr(r,e,t,n,i,o){const s=(e-o)*(t-i),a=(r-i)*(n-o),l=s-a,u=Math.abs(s+a);return Math.abs(l)>=jt*u?l:-rr(r,e,t,n,i,o,u)}var B=63710088e-1,Ve={centimeters:B*100,centimetres:B*100,degrees:B/111325,feet:B*3.28084,inches:B*39.37,kilometers:B/1e3,kilometres:B/1e3,meters:B,metres:B,miles:B/1609.344,millimeters:B*1e3,millimetres:B*1e3,nauticalmiles:B/1852,radians:1,yards:B*1.0936},ir={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/B,yards:1.0936133},Te={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function X(r,e,t){t===void 0&&(t={});var n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=e||{},n.geometry=r,n}function or(r,e,t){switch(r){case"Point":return O(e).geometry;case"LineString":return F(e).geometry;case"Polygon":return ve(e).geometry;case"MultiPoint":return Ot(e).geometry;case"MultiLineString":return Ze(e).geometry;case"MultiPolygon":return Le(e).geometry;default:throw new Error(r+" is invalid")}}function O(r,e,t){if(t===void 0&&(t={}),!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ee(r[0])||!Ee(r[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:r};return X(n,e,t)}function sr(r,e,t){return t===void 0&&(t={}),ee(r.map(function(n){return O(n,e)}),t)}function ve(r,e,t){t===void 0&&(t={});for(var n=0,i=r;n<i.length;n++){var o=i[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}var a={type:"Polygon",coordinates:r};return X(a,e,t)}function ar(r,e,t){return t===void 0&&(t={}),ee(r.map(function(n){return ve(n,e)}),t)}function F(r,e,t){if(t===void 0&&(t={}),r.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:r};return X(n,e,t)}function lr(r,e,t){return t===void 0&&(t={}),ee(r.map(function(n){return F(n,e)}),t)}function ee(r,e){e===void 0&&(e={});var t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=r,t}function Ze(r,e,t){t===void 0&&(t={});var n={type:"MultiLineString",coordinates:r};return X(n,e,t)}function Ot(r,e,t){t===void 0&&(t={});var n={type:"MultiPoint",coordinates:r};return X(n,e,t)}function Le(r,e,t){t===void 0&&(t={});var n={type:"MultiPolygon",coordinates:r};return X(n,e,t)}function ur(r,e,t){t===void 0&&(t={});var n={type:"GeometryCollection",geometries:r};return X(n,e,t)}function fr(r,e){if(e===void 0&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var t=Math.pow(10,e||0);return Math.round(r*t)/t}function He(r,e){e===void 0&&(e="kilometers");var t=Ve[e];if(!t)throw new Error(e+" units is invalid");return r*t}function Re(r,e){e===void 0&&(e="kilometers");var t=Ve[e];if(!t)throw new Error(e+" units is invalid");return r/t}function cr(r,e){return de(Re(r,e))}function hr(r){var e=r%360;return e<0&&(e+=360),e}function de(r){var e=r%(2*Math.PI);return e*180/Math.PI}function Y(r){var e=r%360;return e*Math.PI/180}function dr(r,e,t){if(e===void 0&&(e="kilometers"),t===void 0&&(t="kilometers"),!(r>=0))throw new Error("length must be a positive number");return He(Re(r,e),t)}function gr(r,e,t){if(e===void 0&&(e="meters"),t===void 0&&(t="kilometers"),!(r>=0))throw new Error("area must be a positive number");var n=Te[e];if(!n)throw new Error("invalid original units");var i=Te[t];if(!i)throw new Error("invalid final units");return r/n*i}function Ee(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)}function Ce(r){return!!r&&r.constructor===Object}function mr(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(function(e){if(!Ee(e))throw new Error("bbox must only contain numbers")})}function yr(r){if(!r)throw new Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw new Error("id must be a number or a string")}const vr=Object.freeze(Object.defineProperty({__proto__:null,areaFactors:Te,bearingToAzimuth:hr,convertArea:gr,convertLength:dr,degreesToRadians:Y,earthRadius:B,factors:Ve,feature:X,featureCollection:ee,geometry:or,geometryCollection:ur,isNumber:Ee,isObject:Ce,lengthToDegrees:cr,lengthToRadians:Re,lineString:F,lineStrings:lr,multiLineString:Ze,multiPoint:Ot,multiPolygon:Le,point:O,points:sr,polygon:ve,polygons:ar,radiansToDegrees:de,radiansToLength:He,round:fr,unitsFactors:ir,validateBBox:mr,validateId:yr},Symbol.toStringTag,{value:"Module"})),pr=S.createContext(null);function xr(r,e){const t=Array.isArray(r)?r[0]:r?r.x:0,n=Array.isArray(r)?r[1]:r?r.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,o=Array.isArray(e)?e[1]:e?e.y:0;return t===i&&n===o}function N(r,e){if(r===e)return!0;if(!r||!e)return!1;if(Array.isArray(r)){if(!Array.isArray(e)||r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(!N(r[t],e[t]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof r=="object"&&typeof e=="object"){const t=Object.keys(r),n=Object.keys(e);if(t.length!==n.length)return!1;for(const i of t)if(!e.hasOwnProperty(i)||!N(r[i],e[i]))return!1;return!0}return!1}function wr(r){const e=r.clone();return e.pixelsToGLUnits=r.pixelsToGLUnits,e}function rt(r,e){if(!r.getProjection)return;const t=r.getProjection(),n=e.getProjection();N(t,n)||e.setProjection(t)}function nt(r){return{longitude:r.center.lng,latitude:r.center.lat,zoom:r.zoom,pitch:r.pitch,bearing:r.bearing,padding:r.padding}}function it(r,e){const t=e.viewState||e;let n=!1;if("longitude"in t&&"latitude"in t){const i=r.center;r.center=new i.constructor(t.longitude,t.latitude),n=n||i!==r.center}if("zoom"in t){const i=r.zoom;r.zoom=t.zoom,n=n||i!==r.zoom}if("bearing"in t){const i=r.bearing;r.bearing=t.bearing,n=n||i!==r.bearing}if("pitch"in t){const i=r.pitch;r.pitch=t.pitch,n=n||i!==r.pitch}return t.padding&&!r.isPaddingEqual(t.padding)&&(n=!0,r.padding=t.padding),n}const Er=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ot(r){if(!r)return null;if(typeof r=="string"||("toJS"in r&&(r=r.toJS()),!r.layers))return r;const e={};for(const n of r.layers)e[n.id]=n;const t=r.layers.map(n=>{let i=null;"interactive"in n&&(i=Object.assign({},n),delete i.interactive);const o=e[n.ref];if(o){i=i||Object.assign({},n),delete i.ref;for(const s of Er)s in o&&(i[s]=o[s])}return i||n});return{...r,layers:t}}var st={};const at={version:8,sources:{},layers:[]},lt={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Oe={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},ut={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},br=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Sr=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class se{constructor(e,t,n){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const o=this.props[ut[i.type]];o?o(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const o=this.props[lt[i.type]];o&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),o(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const o=this.props[Oe[i.type]];o&&o(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=t,this._initialize(n)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const t=this.props;this.props=e;const n=this._updateSettings(e,t);n&&this._createShadowTransform(this._map);const i=this._updateSize(e),o=this._updateViewState(e,!0);this._updateStyle(e,t),this._updateStyleComponents(e,t),this._updateHandlers(e,t),(n||i||o&&!this._map.isMoving())&&this.redraw()}static reuse(e,t){const n=se.savedMaps.pop();if(!n)return null;const i=n.map,o=i.getContainer();for(t.className=o.className;o.childNodes.length>0;)t.appendChild(o.childNodes[0]);i._container=t;const s=i._resizeObserver;s&&(s.disconnect(),s.observe(t)),n.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:a}=e;return a&&(a.bounds?i.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):n._updateViewState(a,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),n}_initialize(e){const{props:t}=this,{mapStyle:n=at}=t,i={...t,...t.initialViewState,accessToken:t.mapboxAccessToken||_r()||null,container:e,style:ot(n)},o=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[o.longitude||0,o.latitude||0],zoom:o.zoom||0,pitch:o.pitch||0,bearing:o.bearing||0}),t.gl){const d=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=d,t.gl)}const s=new this._MapClass(i);o.padding&&s.setPadding(o.padding),t.cursor&&(s.getCanvas().style.cursor=t.cursor),this._createShadowTransform(s);const a=s._render;s._render=d=>{this._inRender=!0,a.call(s,d),this._inRender=!1};const l=s._renderTaskQueue.run;s._renderTaskQueue.run=d=>{l.call(s._renderTaskQueue,d),this._onBeforeRepaint()},s.on("render",()=>this._onAfterRepaint());const u=s.fire;s.fire=this._fireEvent.bind(this,u),s.on("resize",()=>{this._renderTransform.resize(s.transform.width,s.transform.height)}),s.on("styledata",()=>{this._updateStyleComponents(this.props,{}),rt(s.transform,this._renderTransform)}),s.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const d in lt)s.on(d,this._onPointerEvent);for(const d in Oe)s.on(d,this._onCameraEvent);for(const d in ut)s.on(d,this._onEvent);this._map=s}recycle(){const t=this.map.getContainer().querySelector("[mapboxgl-children]");t==null||t.remove(),se.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const t=wr(e.transform);e.painter.transform=t,this._renderTransform=t}_updateSize(e){const{viewState:t}=e;if(t){const n=this._map;if(t.width!==n.transform.width||t.height!==n.transform.height)return n.resize(),!0}return!1}_updateViewState(e,t){if(this._internalUpdate)return!1;const n=this._map,i=this._renderTransform,{zoom:o,pitch:s,bearing:a}=i,l=n.isMoving();l&&(i.cameraElevationReference="sea");const u=it(i,{...nt(n.transform),...e});if(l&&(i.cameraElevationReference="ground"),u&&t){const d=this._deferredEvents;d.move=!0,d.zoom||(d.zoom=o!==i.zoom),d.rotate||(d.rotate=a!==i.bearing),d.pitch||(d.pitch=s!==i.pitch)}return l||it(n.transform,e),u}_updateSettings(e,t){const n=this._map;let i=!1;for(const o of br)if(o in e&&!N(e[o],t[o])){i=!0;const s=n[`set${o[0].toUpperCase()}${o.slice(1)}`];s==null||s.call(n,e[o])}return i}_updateStyle(e,t){if(e.cursor!==t.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==t.mapStyle){const{mapStyle:n=at,styleDiffing:i=!0}=e,o={diff:i};return"localIdeographFontFamily"in e&&(o.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(ot(n),o),!0}return!1}_updateStyleComponents(e,t){const n=this._map;let i=!1;return n.isStyleLoaded()&&("light"in e&&n.setLight&&!N(e.light,t.light)&&(i=!0,n.setLight(e.light)),"fog"in e&&n.setFog&&!N(e.fog,t.fog)&&(i=!0,n.setFog(e.fog)),"terrain"in e&&n.setTerrain&&!N(e.terrain,t.terrain)&&(!e.terrain||n.getSource(e.terrain.source))&&(i=!0,n.setTerrain(e.terrain))),i}_updateHandlers(e,t){var n,i;const o=this._map;let s=!1;for(const a of Sr){const l=(n=e[a])!==null&&n!==void 0?n:!0,u=(i=t[a])!==null&&i!==void 0?i:!0;N(l,u)||(s=!0,l?o[a].enable(l):o[a].disable())}return s}_queryRenderedFeatures(e){const t=this._map,n=t.transform,{interactiveLayerIds:i=[]}=this.props;try{return t.transform=this._renderTransform,t.queryRenderedFeatures(e,{layers:i.filter(t.getLayer.bind(t))})}catch{return[]}finally{t.transform=n}}_updateHover(e){var t;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const o=e.type,s=((t=this._hoveredFeatures)===null||t===void 0?void 0:t.length)>0,a=this._queryRenderedFeatures(e.point),l=a.length>0;!l&&s&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,l&&!s&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=o}else this._hoveredFeatures=null}_fireEvent(e,t,n){const i=this._map,o=i.transform,s=typeof t=="string"?t:t.type;return s==="move"&&this._updateViewState(this.props,!1),s in Oe&&(typeof t=="object"&&(t.viewState=nt(o)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,t,n),i.transform=o,i):(e.call(i,t,n),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const n in this._deferredEvents)this._deferredEvents[n]&&e.fire(n);this._internalUpdate=!1;const t=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{rt(this._renderTransform,t),e.transform=t}}}se.savedMaps=[];function _r(){let r=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);r=e&&e[1]}try{r=r||st.MapboxAccessToken}catch{}try{r=r||st.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return r}const Mr=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Pr(r){if(!r)return null;const e=r.map,t={getMap:()=>e,getCenter:()=>r.transform.center,getZoom:()=>r.transform.zoom,getBearing:()=>r.transform.bearing,getPitch:()=>r.transform.pitch,getPadding:()=>r.transform.padding,getBounds:()=>r.transform.getBounds(),project:n=>{const i=e.transform;e.transform=r.transform;const o=e.project(n);return e.transform=i,o},unproject:n=>{const i=e.transform;e.transform=r.transform;const o=e.unproject(n);return e.transform=i,o},queryTerrainElevation:(n,i)=>{const o=e.transform;e.transform=r.transform;const s=e.queryTerrainElevation(n,i);return e.transform=o,s},queryRenderedFeatures:(n,i)=>{const o=e.transform;e.transform=r.transform;const s=e.queryRenderedFeatures(n,i);return e.transform=o,s}};for(const n of Lr(e))!(n in t)&&!Mr.includes(n)&&(t[n]=e[n].bind(e));return t}function Lr(r){const e=new Set;let t=r;for(;t;){for(const n of Object.getOwnPropertyNames(t))n[0]!=="_"&&typeof r[n]=="function"&&n!=="fire"&&n!=="setEventedParent"&&e.add(n);t=Object.getPrototypeOf(t)}return Array.from(e)}const Rr=typeof document<"u"?S.useLayoutEffect:S.useEffect,Cr=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function kr(r,e){for(const n of Cr)n in e&&(r[n]=e[n]);const{RTLTextPlugin:t="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;t&&r.getRTLTextPluginStatus&&r.getRTLTextPluginStatus()==="unavailable"&&r.setRTLTextPlugin(t,n=>{n&&console.error(n)},!0)}const le=S.createContext(null);function Ar(r,e,t){const n=S.useContext(pr),[i,o]=S.useState(null),s=S.useRef(),{current:a}=S.useRef({mapLib:null,map:null});S.useEffect(()=>{const d=r.mapLib;let f=!0,g;return Promise.resolve(d||t).then(y=>{if(!f)return;if(!y)throw new Error("Invalid mapLib");const p="Map"in y?y:y.default;if(!p.Map)throw new Error("Invalid mapLib");if(kr(p,r),!p.supported||p.supported(r))r.reuseMaps&&(g=se.reuse(r,s.current)),g||(g=new se(p.Map,r,s.current)),a.map=Pr(g),a.mapLib=p,o(g),n==null||n.onMapMount(a.map,r.id);else throw new Error("Map is not supported by this browser")}).catch(y=>{const{onError:p}=r;p?p({type:"error",target:null,originalEvent:null,error:y}):console.error(y)}),()=>{f=!1,g&&(n==null||n.onMapUnmount(r.id),r.reuseMaps?g.recycle():g.destroy())}},[]),Rr(()=>{i&&i.setProps(r)}),S.useImperativeHandle(e,()=>a.map,[i]);const l=S.useMemo(()=>({position:"relative",width:"100%",height:"100%",...r.style}),[r.style]),u={height:"100%"};return S.createElement("div",{id:r.id,ref:s,style:l},i&&S.createElement(le.Provider,{value:a},S.createElement("div",{"mapboxgl-children":"",style:u},r.children)))}const Or=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function te(r,e){if(!r||!e)return;const t=r.style;for(const n in e){const i=e[n];Number.isFinite(i)&&!Or.test(n)?t[n]=`${i}px`:t[n]=i}}function Ir(r,e){const{map:t,mapLib:n}=S.useContext(le),i=S.useRef({props:r});i.current.props=r;const o=S.useMemo(()=>{let w=!1;S.Children.forEach(r.children,c=>{c&&(w=!0)});const M={...r,element:w?document.createElement("div"):null},_=new n.Marker(M);return _.setLngLat([r.longitude,r.latitude]),_.getElement().addEventListener("click",c=>{var h,m;(m=(h=i.current.props).onClick)===null||m===void 0||m.call(h,{type:"click",target:_,originalEvent:c})}),_.on("dragstart",c=>{var h,m;const v=c;v.lngLat=o.getLngLat(),(m=(h=i.current.props).onDragStart)===null||m===void 0||m.call(h,v)}),_.on("drag",c=>{var h,m;const v=c;v.lngLat=o.getLngLat(),(m=(h=i.current.props).onDrag)===null||m===void 0||m.call(h,v)}),_.on("dragend",c=>{var h,m;const v=c;v.lngLat=o.getLngLat(),(m=(h=i.current.props).onDragEnd)===null||m===void 0||m.call(h,v)}),_},[]);S.useEffect(()=>(o.addTo(t.getMap()),()=>{o.remove()}),[]);const{longitude:s,latitude:a,offset:l,style:u,draggable:d=!1,popup:f=null,rotation:g=0,rotationAlignment:y="auto",pitchAlignment:p="auto"}=r;return S.useEffect(()=>{te(o.getElement(),u)},[u]),S.useImperativeHandle(e,()=>o,[]),(o.getLngLat().lng!==s||o.getLngLat().lat!==a)&&o.setLngLat([s,a]),l&&!xr(o.getOffset(),l)&&o.setOffset(l),o.isDraggable()!==d&&o.setDraggable(d),o.getRotation()!==g&&o.setRotation(g),o.getRotationAlignment()!==y&&o.setRotationAlignment(y),o.getPitchAlignment()!==p&&o.setPitchAlignment(p),o.getPopup()!==f&&o.setPopup(f),At.createPortal(r.children,o.getElement())}S.memo(S.forwardRef(Ir));function ft(r){return new Set(r?r.trim().split(/\s+/):[])}function Br(r,e){const{map:t,mapLib:n}=S.useContext(le),i=S.useMemo(()=>document.createElement("div"),[]),o=S.useRef({props:r});o.current.props=r;const s=S.useMemo(()=>{const a={...r},l=new n.Popup(a);return l.setLngLat([r.longitude,r.latitude]),l.once("open",u=>{var d,f;(f=(d=o.current.props).onOpen)===null||f===void 0||f.call(d,u)}),l},[]);if(S.useEffect(()=>{const a=l=>{var u,d;(d=(u=o.current.props).onClose)===null||d===void 0||d.call(u,l)};return s.on("close",a),s.setDOMContent(i).addTo(t.getMap()),()=>{s.off("close",a),s.isOpen()&&s.remove()}},[]),S.useEffect(()=>{te(s.getElement(),r.style)},[r.style]),S.useImperativeHandle(e,()=>s,[]),s.isOpen()&&((s.getLngLat().lng!==r.longitude||s.getLngLat().lat!==r.latitude)&&s.setLngLat([r.longitude,r.latitude]),r.offset&&!N(s.options.offset,r.offset)&&s.setOffset(r.offset),(s.options.anchor!==r.anchor||s.options.maxWidth!==r.maxWidth)&&(s.options.anchor=r.anchor,s.setMaxWidth(r.maxWidth)),s.options.className!==r.className)){const a=ft(s.options.className),l=ft(r.className);for(const u of a)l.has(u)||s.removeClassName(u);for(const u of l)a.has(u)||s.addClassName(u);s.options.className=r.className}return At.createPortal(r.children,i)}S.memo(S.forwardRef(Br));function pe(r,e,t,n){const i=S.useContext(le),o=S.useMemo(()=>r(i),[]);return S.useEffect(()=>{const s=e,a=typeof e=="function"&&typeof t=="function"?e:null,l=typeof e=="function"?e:null,{map:u}=i;return u.hasControl(o)||(u.addControl(o,s==null?void 0:s.position),a&&a(i)),()=>{l&&l(i),u.hasControl(o)&&u.removeControl(o)}},[]),o}function Tr(r){const e=pe(({mapLib:t})=>new t.AttributionControl(r),{position:r.position});return S.useEffect(()=>{te(e._container,r.style)},[r.style]),null}S.memo(Tr);function Fr(r){const e=pe(({mapLib:t})=>new t.FullscreenControl({container:r.containerId&&document.getElementById(r.containerId)}),{position:r.position});return S.useEffect(()=>{te(e._controlContainer,r.style)},[r.style]),null}S.memo(Fr);function Nr(r,e){const t=S.useRef({props:r}),n=pe(({mapLib:i})=>{const o=new i.GeolocateControl(r),s=o._setupUI;return o._setupUI=a=>{o._container.hasChildNodes()||s(a)},o.on("geolocate",a=>{var l,u;(u=(l=t.current.props).onGeolocate)===null||u===void 0||u.call(l,a)}),o.on("error",a=>{var l,u;(u=(l=t.current.props).onError)===null||u===void 0||u.call(l,a)}),o.on("outofmaxbounds",a=>{var l,u;(u=(l=t.current.props).onOutOfMaxBounds)===null||u===void 0||u.call(l,a)}),o.on("trackuserlocationstart",a=>{var l,u;(u=(l=t.current.props).onTrackUserLocationStart)===null||u===void 0||u.call(l,a)}),o.on("trackuserlocationend",a=>{var l,u;(u=(l=t.current.props).onTrackUserLocationEnd)===null||u===void 0||u.call(l,a)}),o},{position:r.position});return t.current.props=r,S.useImperativeHandle(e,()=>n,[]),S.useEffect(()=>{te(n._container,r.style)},[r.style]),null}S.memo(S.forwardRef(Nr));function zr(r){const e=pe(({mapLib:t})=>new t.NavigationControl(r),{position:r.position});return S.useEffect(()=>{te(e._container,r.style)},[r.style]),null}S.memo(zr);function Yr(r){const e=pe(({mapLib:o})=>new o.ScaleControl(r),{position:r.position}),t=S.useRef(r),n=t.current;t.current=r;const{style:i}=r;return r.maxWidth!==void 0&&r.maxWidth!==n.maxWidth&&(e.options.maxWidth=r.maxWidth),r.unit!==void 0&&r.unit!==n.unit&&e.setUnit(r.unit),S.useEffect(()=>{te(e._container,i)},[i]),null}S.memo(Yr);function be(r,e){if(!r)throw new Error(e)}function Xr(r,e,t,n){if(be(t.id===n.id,"layer id changed"),be(t.type===n.type,"layer type changed"),t.type==="custom"||n.type==="custom")return;const{layout:i={},paint:o={},filter:s,minzoom:a,maxzoom:l,beforeId:u}=t;if(u!==n.beforeId&&r.moveLayer(e,u),i!==n.layout){const d=n.layout||{};for(const f in i)N(i[f],d[f])||r.setLayoutProperty(e,f,i[f]);for(const f in d)i.hasOwnProperty(f)||r.setLayoutProperty(e,f,void 0)}if(o!==n.paint){const d=n.paint||{};for(const f in o)N(o[f],d[f])||r.setPaintProperty(e,f,o[f]);for(const f in d)o.hasOwnProperty(f)||r.setPaintProperty(e,f,void 0)}N(s,n.filter)||r.setFilter(e,s),(a!==n.minzoom||l!==n.maxzoom)&&r.setLayerZoomRange(e,a,l)}function $r(r,e,t){if(r.style&&r.style._loaded&&(!("source"in t)||r.getSource(t.source))){const n={...t,id:e};delete n.beforeId,r.addLayer(n,t.beforeId)}}let Gr=0;function qr(r){const e=S.useContext(le).map.getMap(),t=S.useRef(r),[,n]=S.useState(0),i=S.useMemo(()=>r.id||`jsx-layer-${Gr++}`,[]);if(S.useEffect(()=>{if(e){const s=()=>n(a=>a+1);return e.on("styledata",s),s(),()=>{e.off("styledata",s),e.style&&e.style._loaded&&e.getLayer(i)&&e.removeLayer(i)}}},[e]),e&&e.style&&e.getLayer(i))try{Xr(e,i,r,t.current)}catch(s){console.warn(s)}else $r(e,i,r);return t.current=r,null}let Dr=0;function Ur(r,e,t){if(r.style&&r.style._loaded){const n={...t};return delete n.id,delete n.children,r.addSource(e,n),r.getSource(e)}return null}function Vr(r,e,t){be(e.id===t.id,"source id changed"),be(e.type===t.type,"source type changed");let n="",i=0;for(const s in e)s!=="children"&&s!=="id"&&!N(t[s],e[s])&&(n=s,i++);if(!i)return;const o=e.type;if(o==="geojson")r.setData(e.data);else if(o==="image")r.updateImage({url:e.url,coordinates:e.coordinates});else if("setCoordinates"in r&&i===1&&n==="coordinates")r.setCoordinates(e.coordinates);else if("setUrl"in r)switch(n){case"url":r.setUrl(e.url);break;case"tiles":r.setTiles(e.tiles);break}else console.warn(`Unable to update <Source> prop: ${n}`)}function Zr(r){const e=S.useContext(le).map.getMap(),t=S.useRef(r),[,n]=S.useState(0),i=S.useMemo(()=>r.id||`jsx-source-${Dr++}`,[]);S.useEffect(()=>{if(e){const s=()=>setTimeout(()=>n(a=>a+1),0);return e.on("styledata",s),s(),()=>{var a;if(e.off("styledata",s),e.style&&e.style._loaded&&e.getSource(i)){const l=(a=e.getStyle())===null||a===void 0?void 0:a.layers;if(l)for(const u of l)u.source===i&&e.removeLayer(u.id);e.removeSource(i)}}}},[e]);let o=e&&e.style&&e.getSource(i);return o?Vr(o,r,t.current):o=Ur(e,i,r),t.current=r,o&&S.Children.map(r.children,s=>s&&S.cloneElement(s,{source:i}))||null}const Hr=Ht(()=>import("./maplibre-gl-Dv-UzEPq.js").then(r=>r.m),__vite__mapDeps([0,1]),import.meta.url),ri=S.forwardRef(function(e,t){return Ar(e,t,Hr)}),ni=qr,ii=Zr;function ue(r,e,t){if(r!==null)for(var n,i,o,s,a,l,u,d=0,f=0,g,y=r.type,p=y==="FeatureCollection",w=y==="Feature",M=p?r.features.length:1,_=0;_<M;_++){u=p?r.features[_].geometry:w?r.geometry:r,g=u?u.type==="GeometryCollection":!1,a=g?u.geometries.length:1;for(var c=0;c<a;c++){var h=0,m=0;if(s=g?u.geometries[c]:u,s!==null){l=s.coordinates;var v=s.type;switch(d=t&&(v==="Polygon"||v==="MultiPolygon")?1:0,v){case null:break;case"Point":if(e(l,f,_,h,m)===!1)return!1;f++,h++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(e(l[n],f,_,h,m)===!1)return!1;f++,v==="MultiPoint"&&h++}v==="LineString"&&h++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(i=0;i<l[n].length-d;i++){if(e(l[n][i],f,_,h,m)===!1)return!1;f++}v==="MultiLineString"&&h++,v==="Polygon"&&m++}v==="Polygon"&&h++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(m=0,i=0;i<l[n].length;i++){for(o=0;o<l[n][i].length-d;o++){if(e(l[n][i][o],f,_,h,m)===!1)return!1;f++}m++}h++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(ue(s.geometries[n],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Qr(r,e,t,n){var i=t;return ue(r,function(o,s,a,l,u){s===0&&t===void 0?i=o:i=e(i,o,s,a,l,u)},n),i}function It(r,e){var t;switch(r.type){case"FeatureCollection":for(t=0;t<r.features.length&&e(r.features[t].properties,t)!==!1;t++);break;case"Feature":e(r.properties,0);break}}function Wr(r,e,t){var n=t;return It(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}function Se(r,e){if(r.type==="Feature")e(r,0);else if(r.type==="FeatureCollection")for(var t=0;t<r.features.length&&e(r.features[t],t)!==!1;t++);}function Jr(r,e,t){var n=t;return Se(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}function Kr(r){var e=[];return ue(r,function(t){e.push(t)}),e}function ke(r,e){var t,n,i,o,s,a,l,u,d,f,g=0,y=r.type==="FeatureCollection",p=r.type==="Feature",w=y?r.features.length:1;for(t=0;t<w;t++){for(a=y?r.features[t].geometry:p?r.geometry:r,u=y?r.features[t].properties:p?r.properties:{},d=y?r.features[t].bbox:p?r.bbox:void 0,f=y?r.features[t].id:p?r.id:void 0,l=a?a.type==="GeometryCollection":!1,s=l?a.geometries.length:1,i=0;i<s;i++){if(o=l?a.geometries[i]:a,o===null){if(e(null,g,u,d,f)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(o,g,u,d,f)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<o.geometries.length;n++)if(e(o.geometries[n],g,u,d,f)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}g++}}function jr(r,e,t){var n=t;return ke(r,function(i,o,s,a,l){o===0&&t===void 0?n=i:n=e(n,i,o,s,a,l)}),n}function fe(r,e){ke(r,function(t,n,i,o,s){var a=t===null?null:t.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return e(X(t,i,{bbox:o,id:s}),n,0)===!1?!1:void 0}var l;switch(a){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}for(var u=0;u<t.coordinates.length;u++){var d=t.coordinates[u],f={type:l,coordinates:d};if(e(X(f,i),n,u)===!1)return!1}})}function en(r,e,t){var n=t;return fe(r,function(i,o,s){o===0&&s===0&&t===void 0?n=i:n=e(n,i,o,s)}),n}function Bt(r,e){fe(r,function(t,n,i){var o=0;if(t.geometry){var s=t.geometry.type;if(!(s==="Point"||s==="MultiPoint")){var a,l=0,u=0,d=0;if(ue(t,function(f,g,y,p,w){if(a===void 0||n>l||p>u||w>d){a=f,l=n,u=p,d=w,o=0;return}var M=F([a,f],t.properties);if(e(M,n,i,w,o)===!1)return!1;o++,a=f})===!1)return!1}}})}function Tt(r,e,t){var n=t,i=!1;return Bt(r,function(o,s,a,l,u){i===!1&&t===void 0?n=o:n=e(n,o,s,a,l,u),i=!0}),n}function Ft(r,e){if(!r)throw new Error("geojson is required");fe(r,function(t,n,i){if(t.geometry!==null){var o=t.geometry.type,s=t.geometry.coordinates;switch(o){case"LineString":if(e(t,n,i,0,0)===!1)return!1;break;case"Polygon":for(var a=0;a<s.length;a++)if(e(F(s[a],t.properties),n,i,a)===!1)return!1;break}}})}function tn(r,e,t){var n=t;return Ft(r,function(i,o,s,a){o===0&&t===void 0?n=i:n=e(n,i,o,s,a)}),n}function rn(r,e){if(e=e||{},!Ce(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.segmentIndex||0,s=e.properties,a;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),s=s||r.features[t].properties,a=r.features[t].geometry;break;case"Feature":s=s||r.properties,a=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":a=r;break;default:throw new Error("geojson is invalid")}if(a===null)return null;var l=a.coordinates;switch(a.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=l.length+o-1),F([l[o],l[o+1]],s,e);case"Polygon":return i<0&&(i=l.length+i),o<0&&(o=l[i].length+o-1),F([l[i][o],l[i][o+1]],s,e);case"MultiLineString":return n<0&&(n=l.length+n),o<0&&(o=l[n].length+o-1),F([l[n][o],l[n][o+1]],s,e);case"MultiPolygon":return n<0&&(n=l.length+n),i<0&&(i=l[n].length+i),o<0&&(o=l[n][i].length-o-1),F([l[n][i][o],l[n][i][o+1]],s,e)}throw new Error("geojson is invalid")}function nn(r,e){if(e=e||{},!Ce(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.coordIndex||0,s=e.properties,a;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),s=s||r.features[t].properties,a=r.features[t].geometry;break;case"Feature":s=s||r.properties,a=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":a=r;break;default:throw new Error("geojson is invalid")}if(a===null)return null;var l=a.coordinates;switch(a.type){case"Point":return O(l,s,e);case"MultiPoint":return n<0&&(n=l.length+n),O(l[n],s,e);case"LineString":return o<0&&(o=l.length+o),O(l[o],s,e);case"Polygon":return i<0&&(i=l.length+i),o<0&&(o=l[i].length+o),O(l[i][o],s,e);case"MultiLineString":return n<0&&(n=l.length+n),o<0&&(o=l[n].length+o),O(l[n][o],s,e);case"MultiPolygon":return n<0&&(n=l.length+n),i<0&&(i=l[n].length+i),o<0&&(o=l[n][i].length-o),O(l[n][i][o],s,e)}throw new Error("geojson is invalid")}const on=Object.freeze(Object.defineProperty({__proto__:null,coordAll:Kr,coordEach:ue,coordReduce:Qr,featureEach:Se,featureReduce:Jr,findPoint:nn,findSegment:rn,flattenEach:fe,flattenReduce:en,geomEach:ke,geomReduce:jr,lineEach:Ft,lineReduce:tn,propEach:It,propReduce:Wr,segmentEach:Bt,segmentReduce:Tt},Symbol.toStringTag,{value:"Module"}));function _e(r){var e=[1/0,1/0,-1/0,-1/0];return ue(r,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}_e.default=_e;const sn=Object.freeze(Object.defineProperty({__proto__:null,default:_e},Symbol.toStringTag,{value:"Module"}));function ae(r){if(!r)throw new Error("coord is required");if(!Array.isArray(r)){if(r.type==="Feature"&&r.geometry!==null&&r.geometry.type==="Point")return r.geometry.coordinates;if(r.type==="Point")return r.coordinates}if(Array.isArray(r)&&r.length>=2&&!Array.isArray(r[0])&&!Array.isArray(r[1]))return r;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function q(r){if(Array.isArray(r))return r;if(r.type==="Feature"){if(r.geometry!==null)return r.geometry.coordinates}else if(r.coordinates)return r.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function ge(r){return r.type==="Feature"?r.geometry:r}function Nt(r,e){return r.type==="FeatureCollection"?"FeatureCollection":r.type==="GeometryCollection"?"GeometryCollection":r.type==="Feature"&&r.geometry!==null?r.geometry.type:r.type}function Qe(r,e,t){if(t===void 0&&(t={}),t.final===!0)return an(r,e);var n=ae(r),i=ae(e),o=Y(n[0]),s=Y(i[0]),a=Y(n[1]),l=Y(i[1]),u=Math.sin(s-o)*Math.cos(l),d=Math.cos(a)*Math.sin(l)-Math.sin(a)*Math.cos(l)*Math.cos(s-o);return de(Math.atan2(u,d))}function an(r,e){var t=Qe(e,r);return t=(t+180)%360,t}function Fe(r,e,t,n){n===void 0&&(n={});var i=ae(r),o=Y(i[0]),s=Y(i[1]),a=Y(t),l=Re(e,n.units),u=Math.asin(Math.sin(s)*Math.cos(l)+Math.cos(s)*Math.sin(l)*Math.cos(a)),d=o+Math.atan2(Math.sin(a)*Math.sin(l)*Math.cos(s),Math.cos(l)-Math.sin(s)*Math.sin(u)),f=de(d),g=de(u);return O([f,g],n.properties)}function j(r,e,t){t===void 0&&(t={});var n=ae(r),i=ae(e),o=Y(i[1]-n[1]),s=Y(i[0]-n[0]),a=Y(n[1]),l=Y(i[1]),u=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(a)*Math.cos(l);return He(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),t.units)}function oi(r,e,t){t===void 0&&(t={});for(var n=ge(r),i=n.coordinates,o=0,s=0;s<i.length&&!(e>=o&&s===i.length-1);s++)if(o>=e){var a=e-o;if(a){var l=Qe(i[s],i[s-1])-180,u=Fe(i[s],a,l,t);return u}else return O(i[s])}else o+=j(i[s],i[s+1],t);return O(i[i.length-1])}function ln(r,e,t){var n=r.length,i=oe(r[0],e),o=[],s,a,l,u,d;for(t||(t=[]),s=1;s<n;s++){for(u=r[s-1],d=r[s],a=l=oe(d,e);;)if(i|a){if(i&a)break;i?(u=Ne(u,d,i,e),i=oe(u,e)):(d=Ne(u,d,a,e),a=oe(d,e))}else{o.push(u),a!==l?(o.push(d),s<n-1&&(t.push(o),o=[])):s===n-1&&o.push(d);break}i=l}return o.length&&t.push(o),t}function un(r,e){var t,n,i,o,s,a,l;for(n=1;n<=8;n*=2){for(t=[],i=r[r.length-1],o=!(oe(i,e)&n),s=0;s<r.length;s++)a=r[s],l=!(oe(a,e)&n),l!==o&&t.push(Ne(i,a,n,e)),l&&t.push(a),i=a,o=l;if(r=t,!r.length)break}return t}function Ne(r,e,t,n){return t&8?[r[0]+(e[0]-r[0])*(n[3]-r[1])/(e[1]-r[1]),n[3]]:t&4?[r[0]+(e[0]-r[0])*(n[1]-r[1])/(e[1]-r[1]),n[1]]:t&2?[n[2],r[1]+(e[1]-r[1])*(n[2]-r[0])/(e[0]-r[0])]:t&1?[n[0],r[1]+(e[1]-r[1])*(n[0]-r[0])/(e[0]-r[0])]:null}function oe(r,e){var t=0;return r[0]<e[0]?t|=1:r[0]>e[2]&&(t|=2),r[1]<e[1]?t|=4:r[1]>e[3]&&(t|=8),t}function si(r,e){var t=ge(r),n=t.type,i=r.type==="Feature"?r.properties:{},o=t.coordinates;switch(n){case"LineString":case"MultiLineString":{var s=[];return n==="LineString"&&(o=[o]),o.forEach(function(a){ln(a,e,s)}),s.length===1?F(s[0],i):Ze(s,i)}case"Polygon":return ve(ct(o,e),i);case"MultiPolygon":return Le(o.map(function(a){return ct(a,e)}),i);default:throw new Error("geometry "+n+" not supported")}}function ct(r,e){for(var t=[],n=0,i=r;n<i.length;n++){var o=i[n],s=un(o,e);s.length>0&&((s[0][0]!==s[s.length-1][0]||s[0][1]!==s[s.length-1][1])&&s.push(s[0]),s.length>=4&&t.push(s))}return t}function ai(r,e,t){if(t===void 0&&(t={}),!r)throw new Error("point is required");if(!e)throw new Error("polygon is required");var n=ae(r),i=ge(e),o=i.type,s=e.bbox,a=i.coordinates;if(s&&fn(n,s)===!1)return!1;o==="Polygon"&&(a=[a]);for(var l=!1,u=0;u<a.length&&!l;u++)if(ht(n,a[u][0],t.ignoreBoundary)){for(var d=!1,f=1;f<a[u].length&&!d;)ht(n,a[u][f],!t.ignoreBoundary)&&(d=!0),f++;d||(l=!0)}return l}function ht(r,e,t){var n=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var i=0,o=e.length-1;i<e.length;o=i++){var s=e[i][0],a=e[i][1],l=e[o][0],u=e[o][1],d=r[1]*(s-l)+a*(l-r[0])+u*(r[0]-s)===0&&(s-r[0])*(l-r[0])<=0&&(a-r[1])*(u-r[1])<=0;if(d)return!t;var f=a>r[1]!=u>r[1]&&r[0]<(l-s)*(r[1]-a)/(u-a)+s;f&&(n=!n)}return n}function fn(r,e){return e[0]<=r[0]&&e[1]<=r[1]&&e[2]>=r[0]&&e[3]>=r[1]}/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function cn(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(d){u=[6,d],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var J=function(){function r(e,t){this.next=null,this.key=e,this.data=t,this.left=null,this.right=null}return r}();function hn(r,e){return r>e?1:r<e?-1:0}function H(r,e,t){for(var n=new J(null,null),i=n,o=n;;){var s=t(r,e.key);if(s<0){if(e.left===null)break;if(t(r,e.left.key)<0){var a=e.left;if(e.left=a.right,a.right=e,e=a,e.left===null)break}o.left=e,o=e,e=e.left}else if(s>0){if(e.right===null)break;if(t(r,e.right.key)>0){var a=e.right;if(e.right=a.left,a.left=e,e=a,e.right===null)break}i.right=e,i=e,e=e.right}else break}return i.right=e.left,o.left=e.right,e.left=n.right,e.right=n.left,e}function Ie(r,e,t,n){var i=new J(r,e);if(t===null)return i.left=i.right=null,i;t=H(r,t,n);var o=n(r,t.key);return o<0?(i.left=t.left,i.right=t,t.left=null):o>=0&&(i.right=t.right,i.left=t,t.right=null),i}function dt(r,e,t){var n=null,i=null;if(e){e=H(r,e,t);var o=t(e.key,r);o===0?(n=e.left,i=e.right):o<0?(i=e.right,e.right=null,n=e):(n=e.left,e.left=null,i=e)}return{left:n,right:i}}function dn(r,e,t){return e===null?r:(r===null||(e=H(r.key,e,t),e.left=r),e)}function ze(r,e,t,n,i){if(r){n(""+e+(t?"└── ":"├── ")+i(r)+`
`);var o=e+(t?"    ":"│   ");r.left&&ze(r.left,o,!1,n,i),r.right&&ze(r.right,o,!0,n,i)}}var We=function(){function r(e){e===void 0&&(e=hn),this._root=null,this._size=0,this._comparator=e}return r.prototype.insert=function(e,t){return this._size++,this._root=Ie(e,t,this._root,this._comparator)},r.prototype.add=function(e,t){var n=new J(e,t);this._root===null&&(n.left=n.right=null,this._size++,this._root=n);var i=this._comparator,o=H(e,this._root,i),s=i(e,o.key);return s===0?this._root=o:(s<0?(n.left=o.left,n.right=o,o.left=null):s>0&&(n.right=o.right,n.left=o,o.right=null),this._size++,this._root=n),this._root},r.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},r.prototype._remove=function(e,t,n){var i;if(t===null)return null;t=H(e,t,n);var o=n(e,t.key);return o===0?(t.left===null?i=t.right:(i=H(e,t.left,n),i.right=t.right),this._size--,i):t},r.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=H(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},r.prototype.findStatic=function(e){for(var t=this._root,n=this._comparator;t;){var i=n(e,t.key);if(i===0)return t;i<0?t=t.left:t=t.right}return null},r.prototype.find=function(e){return this._root&&(this._root=H(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},r.prototype.contains=function(e){for(var t=this._root,n=this._comparator;t;){var i=n(e,t.key);if(i===0)return!0;i<0?t=t.left:t=t.right}return!1},r.prototype.forEach=function(e,t){for(var n=this._root,i=[],o=!1;!o;)n!==null?(i.push(n),n=n.left):i.length!==0?(n=i.pop(),e.call(t,n),n=n.right):o=!0;return this},r.prototype.range=function(e,t,n,i){for(var o=[],s=this._comparator,a=this._root,l;o.length!==0||a;)if(a)o.push(a),a=a.left;else{if(a=o.pop(),l=s(a.key,t),l>0)break;if(s(a.key,e)>=0&&n.call(i,a))return this;a=a.right}return this},r.prototype.keys=function(){var e=[];return this.forEach(function(t){var n=t.key;return e.push(n)}),e},r.prototype.values=function(){var e=[];return this.forEach(function(t){var n=t.data;return e.push(n)}),e},r.prototype.min=function(){return this._root?this.minNode(this._root).key:null},r.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},r.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},r.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},r.prototype.at=function(e){for(var t=this._root,n=!1,i=0,o=[];!n;)if(t)o.push(t),t=t.left;else if(o.length>0){if(t=o.pop(),i===e)return t;i++,t=t.right}else n=!0;return null},r.prototype.next=function(e){var t=this._root,n=null;if(e.right){for(n=e.right;n.left;)n=n.left;return n}for(var i=this._comparator;t;){var o=i(e.key,t.key);if(o===0)break;o<0?(n=t,t=t.left):t=t.right}return n},r.prototype.prev=function(e){var t=this._root,n=null;if(e.left!==null){for(n=e.left;n.right;)n=n.right;return n}for(var i=this._comparator;t;){var o=i(e.key,t.key);if(o===0)break;o<0?t=t.left:(n=t,t=t.right)}return n},r.prototype.clear=function(){return this._root=null,this._size=0,this},r.prototype.toList=function(){return mn(this._root)},r.prototype.load=function(e,t,n){t===void 0&&(t=[]),n===void 0&&(n=!1);var i=e.length,o=this._comparator;if(n&&$e(e,t,0,i-1,o),this._root===null)this._root=Ye(e,t,0,i),this._size=i;else{var s=yn(this.toList(),gn(e,t),o);i=this._size+i,this._root=Xe({head:s},0,i)}return this},r.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(r.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),r.prototype.toString=function(e){e===void 0&&(e=function(n){return String(n.key)});var t=[];return ze(this._root,"",!0,function(n){return t.push(n)},e),t.join("")},r.prototype.update=function(e,t,n){var i=this._comparator,o=dt(e,this._root,i),s=o.left,a=o.right;i(e,t)<0?a=Ie(t,n,a,i):s=Ie(t,n,s,i),this._root=dn(s,a,i)},r.prototype.split=function(e){return dt(e,this._root,this._comparator)},r.prototype[Symbol.iterator]=function(){var e,t,n;return cn(this,function(i){switch(i.label){case 0:e=this._root,t=[],n=!1,i.label=1;case 1:return n?[3,6]:e===null?[3,2]:(t.push(e),e=e.left,[3,5]);case 2:return t.length===0?[3,4]:(e=t.pop(),[4,e]);case 3:return i.sent(),e=e.right,[3,5];case 4:n=!0,i.label=5;case 5:return[3,1];case 6:return[2]}})},r}();function Ye(r,e,t,n){var i=n-t;if(i>0){var o=t+Math.floor(i/2),s=r[o],a=e[o],l=new J(s,a);return l.left=Ye(r,e,t,o),l.right=Ye(r,e,o+1,n),l}return null}function gn(r,e){for(var t=new J(null,null),n=t,i=0;i<r.length;i++)n=n.next=new J(r[i],e[i]);return n.next=null,t.next}function mn(r){for(var e=r,t=[],n=!1,i=new J(null,null),o=i;!n;)e?(t.push(e),e=e.left):t.length>0?(e=o=o.next=t.pop(),e=e.right):n=!0;return o.next=null,i.next}function Xe(r,e,t){var n=t-e;if(n>0){var i=e+Math.floor(n/2),o=Xe(r,e,i),s=r.head;return s.left=o,r.head=r.head.next,s.right=Xe(r,i+1,t),s}return null}function yn(r,e,t){for(var n=new J(null,null),i=n,o=r,s=e;o!==null&&s!==null;)t(o.key,s.key)<0?(i.next=o,o=o.next):(i.next=s,s=s.next),i=i.next;return o!==null?i.next=o:s!==null&&(i.next=s),n.next}function $e(r,e,t,n,i){if(!(t>=n)){for(var o=r[t+n>>1],s=t-1,a=n+1;;){do s++;while(i(r[s],o)<0);do a--;while(i(r[a],o)>0);if(s>=a)break;var l=r[s];r[s]=r[a],r[a]=l,l=e[s],e[s]=e[a],e[a]=l}$e(r,e,t,a,i),$e(r,e,a+1,n,i)}}var zt={};const he=(r,e)=>r.ll.x<=e.x&&e.x<=r.ur.x&&r.ll.y<=e.y&&e.y<=r.ur.y,Ge=(r,e)=>{if(e.ur.x<r.ll.x||r.ur.x<e.ll.x||e.ur.y<r.ll.y||r.ur.y<e.ll.y)return null;const t=r.ll.x<e.ll.x?e.ll.x:r.ll.x,n=r.ur.x<e.ur.x?r.ur.x:e.ur.x,i=r.ll.y<e.ll.y?e.ll.y:r.ll.y,o=r.ur.y<e.ur.y?r.ur.y:e.ur.y;return{ll:{x:t,y:i},ur:{x:n,y:o}}};let Q=Number.EPSILON;Q===void 0&&(Q=Math.pow(2,-52));const vn=Q*Q,gt=(r,e)=>{if(-Q<r&&r<Q&&-Q<e&&e<Q)return 0;const t=r-e;return t*t<vn*r*e?0:r<e?-1:1};class pn{constructor(){this.reset()}reset(){this.xRounder=new mt,this.yRounder=new mt}round(e,t){return{x:this.xRounder.round(e),y:this.yRounder.round(t)}}}class mt{constructor(){this.tree=new We,this.round(0)}round(e){const t=this.tree.add(e),n=this.tree.prev(t);if(n!==null&&gt(t.key,n.key)===0)return this.tree.remove(e),n.key;const i=this.tree.next(t);return i!==null&&gt(t.key,i.key)===0?(this.tree.remove(e),i.key):e}}const me=new pn,we=(r,e)=>r.x*e.y-r.y*e.x,Yt=(r,e)=>r.x*e.x+r.y*e.y,yt=(r,e,t)=>{const n=nr(r.x,r.y,e.x,e.y,t.x,t.y);return n>0?-1:n<0?1:0},Me=r=>Math.sqrt(Yt(r,r)),xn=(r,e,t)=>{const n={x:e.x-r.x,y:e.y-r.y},i={x:t.x-r.x,y:t.y-r.y};return we(i,n)/Me(i)/Me(n)},wn=(r,e,t)=>{const n={x:e.x-r.x,y:e.y-r.y},i={x:t.x-r.x,y:t.y-r.y};return Yt(i,n)/Me(i)/Me(n)},vt=(r,e,t)=>e.y===0?null:{x:r.x+e.x/e.y*(t-r.y),y:t},pt=(r,e,t)=>e.x===0?null:{x:t,y:r.y+e.y/e.x*(t-r.x)},En=(r,e,t,n)=>{if(e.x===0)return pt(t,n,r.x);if(n.x===0)return pt(r,e,t.x);if(e.y===0)return vt(t,n,r.y);if(n.y===0)return vt(r,e,t.y);const i=we(e,n);if(i==0)return null;const o={x:t.x-r.x,y:t.y-r.y},s=we(o,e)/i,a=we(o,n)/i,l=r.x+a*e.x,u=t.x+s*n.x,d=r.y+a*e.y,f=t.y+s*n.y,g=(l+u)/2,y=(d+f)/2;return{x:g,y}};class z{static compare(e,t){const n=z.comparePoints(e.point,t.point);return n!==0?n:(e.point!==t.point&&e.link(t),e.isLeft!==t.isLeft?e.isLeft?1:-1:W.compare(e.segment,t.segment))}static comparePoints(e,t){return e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0}constructor(e,t){e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=t}link(e){if(e.point===this.point)throw new Error("Tried to link already linked events");const t=e.point.events;for(let n=0,i=t.length;n<i;n++){const o=t[n];this.point.events.push(o),o.point=this.point}this.checkForConsuming()}checkForConsuming(){const e=this.point.events.length;for(let t=0;t<e;t++){const n=this.point.events[t];if(n.segment.consumedBy===void 0)for(let i=t+1;i<e;i++){const o=this.point.events[i];o.consumedBy===void 0&&n.otherSE.point.events===o.otherSE.point.events&&n.segment.consume(o.segment)}}}getAvailableLinkedEvents(){const e=[];for(let t=0,n=this.point.events.length;t<n;t++){const i=this.point.events[t];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&e.push(i)}return e}getLeftmostComparator(e){const t=new Map,n=i=>{const o=i.otherSE;t.set(i,{sine:xn(this.point,e.point,o.point),cosine:wn(this.point,e.point,o.point)})};return(i,o)=>{t.has(i)||n(i),t.has(o)||n(o);const{sine:s,cosine:a}=t.get(i),{sine:l,cosine:u}=t.get(o);return s>=0&&l>=0?a<u?1:a>u?-1:0:s<0&&l<0?a<u?-1:a>u?1:0:l<s?-1:l>s?1:0}}}let bn=0;class W{static compare(e,t){const n=e.leftSE.point.x,i=t.leftSE.point.x,o=e.rightSE.point.x,s=t.rightSE.point.x;if(s<n)return 1;if(o<i)return-1;const a=e.leftSE.point.y,l=t.leftSE.point.y,u=e.rightSE.point.y,d=t.rightSE.point.y;if(n<i){if(l<a&&l<u)return 1;if(l>a&&l>u)return-1;const f=e.comparePoint(t.leftSE.point);if(f<0)return 1;if(f>0)return-1;const g=t.comparePoint(e.rightSE.point);return g!==0?g:-1}if(n>i){if(a<l&&a<d)return-1;if(a>l&&a>d)return 1;const f=t.comparePoint(e.leftSE.point);if(f!==0)return f;const g=e.comparePoint(t.rightSE.point);return g<0?1:g>0?-1:1}if(a<l)return-1;if(a>l)return 1;if(o<s){const f=t.comparePoint(e.rightSE.point);if(f!==0)return f}if(o>s){const f=e.comparePoint(t.rightSE.point);if(f<0)return 1;if(f>0)return-1}if(o!==s){const f=u-a,g=o-n,y=d-l,p=s-i;if(f>g&&y<p)return 1;if(f<g&&y>p)return-1}return o>s?1:o<s||u<d?-1:u>d?1:e.id<t.id?-1:e.id>t.id?1:0}constructor(e,t,n,i){this.id=++bn,this.leftSE=e,e.segment=this,e.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=e,this.rings=n,this.windings=i}static fromRing(e,t,n){let i,o,s;const a=z.comparePoints(e,t);if(a<0)i=e,o=t,s=1;else if(a>0)i=t,o=e,s=-1;else throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);const l=new z(i,!0),u=new z(o,!1);return new W(l,u,[n],[s])}replaceRightSE(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const e=this.leftSE.point.y,t=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<t?e:t},ur:{x:this.rightSE.point.x,y:e>t?e:t}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}comparePoint(e){if(this.isAnEndpoint(e))return 0;const t=this.leftSE.point,n=this.rightSE.point,i=this.vector();if(t.x===n.x)return e.x===t.x?0:e.x<t.x?1:-1;const o=(e.y-t.y)/i.y,s=t.x+o*i.x;if(e.x===s)return 0;const a=(e.x-t.x)/i.x,l=t.y+a*i.y;return e.y===l?0:e.y<l?-1:1}getIntersection(e){const t=this.bbox(),n=e.bbox(),i=Ge(t,n);if(i===null)return null;const o=this.leftSE.point,s=this.rightSE.point,a=e.leftSE.point,l=e.rightSE.point,u=he(t,a)&&this.comparePoint(a)===0,d=he(n,o)&&e.comparePoint(o)===0,f=he(t,l)&&this.comparePoint(l)===0,g=he(n,s)&&e.comparePoint(s)===0;if(d&&u)return g&&!f?s:!g&&f?l:null;if(d)return f&&o.x===l.x&&o.y===l.y?null:o;if(u)return g&&s.x===a.x&&s.y===a.y?null:a;if(g&&f)return null;if(g)return s;if(f)return l;const y=En(o,this.vector(),a,e.vector());return y===null||!he(i,y)?null:me.round(y.x,y.y)}split(e){const t=[],n=e.events!==void 0,i=new z(e,!0),o=new z(e,!1),s=this.rightSE;this.replaceRightSE(o),t.push(o),t.push(i);const a=new W(i,s,this.rings.slice(),this.windings.slice());return z.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),z.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(i.checkForConsuming(),o.checkForConsuming()),t}swapEvents(){const e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let t=0,n=this.windings.length;t<n;t++)this.windings[t]*=-1}consume(e){let t=this,n=e;for(;t.consumedBy;)t=t.consumedBy;for(;n.consumedBy;)n=n.consumedBy;const i=W.compare(t,n);if(i!==0){if(i>0){const o=t;t=n,n=o}if(t.prev===n){const o=t;t=n,n=o}for(let o=0,s=n.rings.length;o<s;o++){const a=n.rings[o],l=n.windings[o],u=t.rings.indexOf(a);u===-1?(t.rings.push(a),t.windings.push(l)):t.windings[u]+=l}n.rings=null,n.windings=null,n.consumedBy=t,n.leftSE.consumedBy=t.leftSE,n.rightSE.consumedBy=t.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};const t=this._afterState.rings,n=this._afterState.windings,i=this._afterState.multiPolys;for(let a=0,l=this.rings.length;a<l;a++){const u=this.rings[a],d=this.windings[a],f=t.indexOf(u);f===-1?(t.push(u),n.push(d)):n[f]+=d}const o=[],s=[];for(let a=0,l=t.length;a<l;a++){if(n[a]===0)continue;const u=t[a],d=u.poly;if(s.indexOf(d)===-1)if(u.isExterior)o.push(d);else{s.indexOf(d)===-1&&s.push(d);const f=o.indexOf(u.poly);f!==-1&&o.splice(f,1)}}for(let a=0,l=o.length;a<l;a++){const u=o[a].multiPoly;i.indexOf(u)===-1&&i.push(u)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const e=this.beforeState().multiPolys,t=this.afterState().multiPolys;switch(G.type){case"union":{const n=e.length===0,i=t.length===0;this._isInResult=n!==i;break}case"intersection":{let n,i;e.length<t.length?(n=e.length,i=t.length):(n=t.length,i=e.length),this._isInResult=i===G.numMultiPolys&&n<i;break}case"xor":{const n=Math.abs(e.length-t.length);this._isInResult=n%2===1;break}case"difference":{const n=i=>i.length===1&&i[0].isSubject;this._isInResult=n(e)!==n(t);break}default:throw new Error(`Unrecognized operation type found ${G.type}`)}return this._isInResult}}class xt{constructor(e,t,n){if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=t,this.isExterior=n,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=me.round(e[0][0],e[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let o=i;for(let s=1,a=e.length;s<a;s++){if(typeof e[s][0]!="number"||typeof e[s][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let l=me.round(e[s][0],e[s][1]);l.x===o.x&&l.y===o.y||(this.segments.push(W.fromRing(o,l,this)),l.x<this.bbox.ll.x&&(this.bbox.ll.x=l.x),l.y<this.bbox.ll.y&&(this.bbox.ll.y=l.y),l.x>this.bbox.ur.x&&(this.bbox.ur.x=l.x),l.y>this.bbox.ur.y&&(this.bbox.ur.y=l.y),o=l)}(i.x!==o.x||i.y!==o.y)&&this.segments.push(W.fromRing(o,i,this))}getSweepEvents(){const e=[];for(let t=0,n=this.segments.length;t<n;t++){const i=this.segments[t];e.push(i.leftSE),e.push(i.rightSE)}return e}}class Sn{constructor(e,t){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new xt(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let n=1,i=e.length;n<i;n++){const o=new xt(e[n],this,!1);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.interiorRings.push(o)}this.multiPoly=t}getSweepEvents(){const e=this.exteriorRing.getSweepEvents();for(let t=0,n=this.interiorRings.length;t<n;t++){const i=this.interiorRings[t].getSweepEvents();for(let o=0,s=i.length;o<s;o++)e.push(i[o])}return e}}class wt{constructor(e,t){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let n=0,i=e.length;n<i;n++){const o=new Sn(e[n],this);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.polys.push(o)}this.isSubject=t}getSweepEvents(){const e=[];for(let t=0,n=this.polys.length;t<n;t++){const i=this.polys[t].getSweepEvents();for(let o=0,s=i.length;o<s;o++)e.push(i[o])}return e}}class Pe{static factory(e){const t=[];for(let n=0,i=e.length;n<i;n++){const o=e[n];if(!o.isInResult()||o.ringOut)continue;let s=null,a=o.leftSE,l=o.rightSE;const u=[a],d=a.point,f=[];for(;s=a,a=l,u.push(a),a.point!==d;)for(;;){const g=a.getAvailableLinkedEvents();if(g.length===0){const w=u[0].point,M=u[u.length-1].point;throw new Error(`Unable to complete output ring starting at [${w.x}, ${w.y}]. Last matching segment found ends at [${M.x}, ${M.y}].`)}if(g.length===1){l=g[0].otherSE;break}let y=null;for(let w=0,M=f.length;w<M;w++)if(f[w].point===a.point){y=w;break}if(y!==null){const w=f.splice(y)[0],M=u.splice(w.index);M.unshift(M[0].otherSE),t.push(new Pe(M.reverse()));continue}f.push({index:u.length,point:a.point});const p=a.getLeftmostComparator(s);l=g.sort(p)[0].otherSE;break}t.push(new Pe(u))}return t}constructor(e){this.events=e;for(let t=0,n=e.length;t<n;t++)e[t].segment.ringOut=this;this.poly=null}getGeom(){let e=this.events[0].point;const t=[e];for(let u=1,d=this.events.length-1;u<d;u++){const f=this.events[u].point,g=this.events[u+1].point;yt(f,e,g)!==0&&(t.push(f),e=f)}if(t.length===1)return null;const n=t[0],i=t[1];yt(n,e,i)===0&&t.shift(),t.push(t[0]);const o=this.isExteriorRing()?1:-1,s=this.isExteriorRing()?0:t.length-1,a=this.isExteriorRing()?t.length:-1,l=[];for(let u=s;u!=a;u+=o)l.push([t[u].x,t[u].y]);return l}isExteriorRing(){if(this._isExteriorRing===void 0){const e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let e=this.events[0];for(let i=1,o=this.events.length;i<o;i++){const s=this.events[i];z.compare(e,s)>0&&(e=s)}let t=e.segment.prevInResult(),n=t?t.prevInResult():null;for(;;){if(!t)return null;if(!n)return t.ringOut;if(n.ringOut!==t.ringOut)return n.ringOut.enclosingRing()!==t.ringOut?t.ringOut:t.ringOut.enclosingRing();t=n.prevInResult(),n=t?t.prevInResult():null}}}class Et{constructor(e){this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){const e=[this.exteriorRing.getGeom()];if(e[0]===null)return null;for(let t=0,n=this.interiorRings.length;t<n;t++){const i=this.interiorRings[t].getGeom();i!==null&&e.push(i)}return e}}class _n{constructor(e){this.rings=e,this.polys=this._composePolys(e)}getGeom(){const e=[];for(let t=0,n=this.polys.length;t<n;t++){const i=this.polys[t].getGeom();i!==null&&e.push(i)}return e}_composePolys(e){const t=[];for(let n=0,i=e.length;n<i;n++){const o=e[n];if(!o.poly)if(o.isExteriorRing())t.push(new Et(o));else{const s=o.enclosingRing();s.poly||t.push(new Et(s)),s.poly.addInterior(o)}}return t}}class Mn{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W.compare;this.queue=e,this.tree=new We(t),this.segments=[]}process(e){const t=e.segment,n=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(t),n;const i=e.isLeft?this.tree.add(t):this.tree.find(t);if(!i)throw new Error(`Unable to find segment #${t.id} [${t.leftSE.point.x}, ${t.leftSE.point.y}] -> [${t.rightSE.point.x}, ${t.rightSE.point.y}] in SweepLine tree.`);let o=i,s=i,a,l;for(;a===void 0;)o=this.tree.prev(o),o===null?a=null:o.key.consumedBy===void 0&&(a=o.key);for(;l===void 0;)s=this.tree.next(s),s===null?l=null:s.key.consumedBy===void 0&&(l=s.key);if(e.isLeft){let u=null;if(a){const f=a.getIntersection(t);if(f!==null&&(t.isAnEndpoint(f)||(u=f),!a.isAnEndpoint(f))){const g=this._splitSafely(a,f);for(let y=0,p=g.length;y<p;y++)n.push(g[y])}}let d=null;if(l){const f=l.getIntersection(t);if(f!==null&&(t.isAnEndpoint(f)||(d=f),!l.isAnEndpoint(f))){const g=this._splitSafely(l,f);for(let y=0,p=g.length;y<p;y++)n.push(g[y])}}if(u!==null||d!==null){let f=null;u===null?f=d:d===null?f=u:f=z.comparePoints(u,d)<=0?u:d,this.queue.remove(t.rightSE),n.push(t.rightSE);const g=t.split(f);for(let y=0,p=g.length;y<p;y++)n.push(g[y])}n.length>0?(this.tree.remove(t),n.push(e)):(this.segments.push(t),t.prev=a)}else{if(a&&l){const u=a.getIntersection(l);if(u!==null){if(!a.isAnEndpoint(u)){const d=this._splitSafely(a,u);for(let f=0,g=d.length;f<g;f++)n.push(d[f])}if(!l.isAnEndpoint(u)){const d=this._splitSafely(l,u);for(let f=0,g=d.length;f<g;f++)n.push(d[f])}}}this.tree.remove(t)}return n}_splitSafely(e,t){this.tree.remove(e);const n=e.rightSE;this.queue.remove(n);const i=e.split(t);return i.push(n),e.consumedBy===void 0&&this.tree.add(e),i}}const bt=typeof process<"u"&&zt.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Pn=typeof process<"u"&&zt.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class Ln{run(e,t,n){G.type=e,me.reset();const i=[new wt(t,!0)];for(let f=0,g=n.length;f<g;f++)i.push(new wt(n[f],!1));if(G.numMultiPolys=i.length,G.type==="difference"){const f=i[0];let g=1;for(;g<i.length;)Ge(i[g].bbox,f.bbox)!==null?g++:i.splice(g,1)}if(G.type==="intersection")for(let f=0,g=i.length;f<g;f++){const y=i[f];for(let p=f+1,w=i.length;p<w;p++)if(Ge(y.bbox,i[p].bbox)===null)return[]}const o=new We(z.compare);for(let f=0,g=i.length;f<g;f++){const y=i[f].getSweepEvents();for(let p=0,w=y.length;p<w;p++)if(o.insert(y[p]),o.size>bt)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const s=new Mn(o);let a=o.size,l=o.pop();for(;l;){const f=l.key;if(o.size===a){const y=f.segment;throw new Error(`Unable to pop() ${f.isLeft?"left":"right"} SweepEvent [${f.point.x}, ${f.point.y}] from segment #${y.id} [${y.leftSE.point.x}, ${y.leftSE.point.y}] -> [${y.rightSE.point.x}, ${y.rightSE.point.y}] from queue.`)}if(o.size>bt)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(s.segments.length>Pn)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const g=s.process(f);for(let y=0,p=g.length;y<p;y++){const w=g[y];w.consumedBy===void 0&&o.insert(w)}a=o.size,l=o.pop()}me.reset();const u=Pe.factory(s.segments);return new _n(u).getGeom()}}const G=new Ln,Rn=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return G.run("union",r,t)},Cn=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return G.run("intersection",r,t)},kn=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return G.run("xor",r,t)},An=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return G.run("difference",r,t)};var On={union:Rn,intersection:Cn,xor:kn,difference:An};function li(r,e,t){t===void 0&&(t={});var n=ge(r),i=ge(e),o=On.intersection(n.coordinates,i.coordinates);return o.length===0?null:o.length===1?ve(o[0],t.properties):Le(o,t.properties)}function ui(r,e){return e===void 0&&(e={}),Tt(r,function(t,n){var i=n.geometry.coordinates;return t+j(i[0],i[1],e)},0)}function St(r){if(!r)throw new Error("geojson is required");var e=[];return fe(r,function(t){In(t,e)}),ee(e)}function In(r,e){var t=[],n=r.geometry;if(n!==null){switch(n.type){case"Polygon":t=q(n);break;case"LineString":t=[q(n)]}t.forEach(function(i){var o=Bn(i,r.properties);o.forEach(function(s){s.id=e.length,e.push(s)})})}}function Bn(r,e){var t=[];return r.reduce(function(n,i){var o=F([n,i],e);return o.bbox=Tn(n,i),t.push(o),i}),t}function Tn(r,e){var t=r[0],n=r[1],i=e[0],o=e[1],s=t<i?t:i,a=n<o?n:o,l=t>i?t:i,u=n>o?n:o;return[s,a,l,u]}var Je={exports:{}},Xt={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(Qt,function(){function t(c,h,m,v,x){(function E(b,P,L,R,k){for(;R>L;){if(R-L>600){var C=R-L+1,A=P-L+1,K=Math.log(C),U=.5*Math.exp(2*K/3),Z=.5*Math.sqrt(K*U*(C-U)/C)*(A-C/2<0?-1:1),re=Math.max(L,Math.floor(P-A*U/C+Z)),Zt=Math.min(R,Math.floor(P+(C-A)*U/C+Z));E(b,P,re,Zt,k)}var xe=b[P],ce=L,$=R;for(n(b,L,P),k(b[R],xe)>0&&n(b,L,R);ce<$;){for(n(b,ce,$),ce++,$--;k(b[ce],xe)<0;)ce++;for(;k(b[$],xe)>0;)$--}k(b[L],xe)===0?n(b,L,$):n(b,++$,R),$<=P&&(L=$+1),P<=$&&(R=$-1)}})(c,h,m||0,v||c.length-1,x||i)}function n(c,h,m){var v=c[h];c[h]=c[m],c[m]=v}function i(c,h){return c<h?-1:c>h?1:0}var o=function(c){c===void 0&&(c=9),this._maxEntries=Math.max(4,c),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function s(c,h,m){if(!m)return h.indexOf(c);for(var v=0;v<h.length;v++)if(m(c,h[v]))return v;return-1}function a(c,h){l(c,0,c.children.length,h,c)}function l(c,h,m,v,x){x||(x=M(null)),x.minX=1/0,x.minY=1/0,x.maxX=-1/0,x.maxY=-1/0;for(var E=h;E<m;E++){var b=c.children[E];u(x,c.leaf?v(b):b)}return x}function u(c,h){return c.minX=Math.min(c.minX,h.minX),c.minY=Math.min(c.minY,h.minY),c.maxX=Math.max(c.maxX,h.maxX),c.maxY=Math.max(c.maxY,h.maxY),c}function d(c,h){return c.minX-h.minX}function f(c,h){return c.minY-h.minY}function g(c){return(c.maxX-c.minX)*(c.maxY-c.minY)}function y(c){return c.maxX-c.minX+(c.maxY-c.minY)}function p(c,h){return c.minX<=h.minX&&c.minY<=h.minY&&h.maxX<=c.maxX&&h.maxY<=c.maxY}function w(c,h){return h.minX<=c.maxX&&h.minY<=c.maxY&&h.maxX>=c.minX&&h.maxY>=c.minY}function M(c){return{children:c,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function _(c,h,m,v,x){for(var E=[h,m];E.length;)if(!((m=E.pop())-(h=E.pop())<=v)){var b=h+Math.ceil((m-h)/v/2)*v;t(c,b,h,m,x),E.push(h,b,b,m)}}return o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(c){var h=this.data,m=[];if(!w(c,h))return m;for(var v=this.toBBox,x=[];h;){for(var E=0;E<h.children.length;E++){var b=h.children[E],P=h.leaf?v(b):b;w(c,P)&&(h.leaf?m.push(b):p(c,P)?this._all(b,m):x.push(b))}h=x.pop()}return m},o.prototype.collides=function(c){var h=this.data;if(!w(c,h))return!1;for(var m=[];h;){for(var v=0;v<h.children.length;v++){var x=h.children[v],E=h.leaf?this.toBBox(x):x;if(w(c,E)){if(h.leaf||p(c,E))return!0;m.push(x)}}h=m.pop()}return!1},o.prototype.load=function(c){if(!c||!c.length)return this;if(c.length<this._minEntries){for(var h=0;h<c.length;h++)this.insert(c[h]);return this}var m=this._build(c.slice(),0,c.length-1,0);if(this.data.children.length)if(this.data.height===m.height)this._splitRoot(this.data,m);else{if(this.data.height<m.height){var v=this.data;this.data=m,m=v}this._insert(m,this.data.height-m.height-1,!0)}else this.data=m;return this},o.prototype.insert=function(c){return c&&this._insert(c,this.data.height-1),this},o.prototype.clear=function(){return this.data=M([]),this},o.prototype.remove=function(c,h){if(!c)return this;for(var m,v,x,E=this.data,b=this.toBBox(c),P=[],L=[];E||P.length;){if(E||(E=P.pop(),v=P[P.length-1],m=L.pop(),x=!0),E.leaf){var R=s(c,E.children,h);if(R!==-1)return E.children.splice(R,1),P.push(E),this._condense(P),this}x||E.leaf||!p(E,b)?v?(m++,E=v.children[m],x=!1):E=null:(P.push(E),L.push(m),m=0,v=E,E=E.children[0])}return this},o.prototype.toBBox=function(c){return c},o.prototype.compareMinX=function(c,h){return c.minX-h.minX},o.prototype.compareMinY=function(c,h){return c.minY-h.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(c){return this.data=c,this},o.prototype._all=function(c,h){for(var m=[];c;)c.leaf?h.push.apply(h,c.children):m.push.apply(m,c.children),c=m.pop();return h},o.prototype._build=function(c,h,m,v){var x,E=m-h+1,b=this._maxEntries;if(E<=b)return a(x=M(c.slice(h,m+1)),this.toBBox),x;v||(v=Math.ceil(Math.log(E)/Math.log(b)),b=Math.ceil(E/Math.pow(b,v-1))),(x=M([])).leaf=!1,x.height=v;var P=Math.ceil(E/b),L=P*Math.ceil(Math.sqrt(b));_(c,h,m,L,this.compareMinX);for(var R=h;R<=m;R+=L){var k=Math.min(R+L-1,m);_(c,R,k,P,this.compareMinY);for(var C=R;C<=k;C+=P){var A=Math.min(C+P-1,k);x.children.push(this._build(c,C,A,v-1))}}return a(x,this.toBBox),x},o.prototype._chooseSubtree=function(c,h,m,v){for(;v.push(h),!h.leaf&&v.length-1!==m;){for(var x=1/0,E=1/0,b=void 0,P=0;P<h.children.length;P++){var L=h.children[P],R=g(L),k=(C=c,A=L,(Math.max(A.maxX,C.maxX)-Math.min(A.minX,C.minX))*(Math.max(A.maxY,C.maxY)-Math.min(A.minY,C.minY))-R);k<E?(E=k,x=R<x?R:x,b=L):k===E&&R<x&&(x=R,b=L)}h=b||h.children[0]}var C,A;return h},o.prototype._insert=function(c,h,m){var v=m?c:this.toBBox(c),x=[],E=this._chooseSubtree(v,this.data,h,x);for(E.children.push(c),u(E,v);h>=0&&x[h].children.length>this._maxEntries;)this._split(x,h),h--;this._adjustParentBBoxes(v,x,h)},o.prototype._split=function(c,h){var m=c[h],v=m.children.length,x=this._minEntries;this._chooseSplitAxis(m,x,v);var E=this._chooseSplitIndex(m,x,v),b=M(m.children.splice(E,m.children.length-E));b.height=m.height,b.leaf=m.leaf,a(m,this.toBBox),a(b,this.toBBox),h?c[h-1].children.push(b):this._splitRoot(m,b)},o.prototype._splitRoot=function(c,h){this.data=M([c,h]),this.data.height=c.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(c,h,m){for(var v,x,E,b,P,L,R,k=1/0,C=1/0,A=h;A<=m-h;A++){var K=l(c,0,A,this.toBBox),U=l(c,A,m,this.toBBox),Z=(x=K,E=U,b=void 0,P=void 0,L=void 0,R=void 0,b=Math.max(x.minX,E.minX),P=Math.max(x.minY,E.minY),L=Math.min(x.maxX,E.maxX),R=Math.min(x.maxY,E.maxY),Math.max(0,L-b)*Math.max(0,R-P)),re=g(K)+g(U);Z<k?(k=Z,v=A,C=re<C?re:C):Z===k&&re<C&&(C=re,v=A)}return v||m-h},o.prototype._chooseSplitAxis=function(c,h,m){var v=c.leaf?this.compareMinX:d,x=c.leaf?this.compareMinY:f;this._allDistMargin(c,h,m,v)<this._allDistMargin(c,h,m,x)&&c.children.sort(v)},o.prototype._allDistMargin=function(c,h,m,v){c.children.sort(v);for(var x=this.toBBox,E=l(c,0,h,x),b=l(c,m-h,m,x),P=y(E)+y(b),L=h;L<m-h;L++){var R=c.children[L];u(E,c.leaf?x(R):R),P+=y(E)}for(var k=m-h-1;k>=h;k--){var C=c.children[k];u(b,c.leaf?x(C):C),P+=y(b)}return P},o.prototype._adjustParentBBoxes=function(c,h,m){for(var v=m;v>=0;v--)u(h[v],c)},o.prototype._condense=function(c){for(var h=c.length-1,m=void 0;h>=0;h--)c[h].children.length===0?h>0?(m=c[h-1].children).splice(m.indexOf(c[h]),1):this.clear():a(c[h],this.toBBox)},o})})(Xt);var Fn=Xt.exports;const Nn=Ue(vr),zn=Ue(on),Yn=Ue(sn);var D=Fn,$t=Nn,Gt=zn,ie=Yn.default,Xn=Gt.featureEach;Gt.coordEach;$t.polygon;var _t=$t.featureCollection;function qt(r){var e=new D(r);return e.insert=function(t){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:ie(t),D.prototype.insert.call(this,t)},e.load=function(t){var n=[];return Array.isArray(t)?t.forEach(function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:ie(i),n.push(i)}):Xn(t,function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:ie(i),n.push(i)}),D.prototype.load.call(this,n)},e.remove=function(t,n){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:ie(t),D.prototype.remove.call(this,t,n)},e.clear=function(){return D.prototype.clear.call(this)},e.search=function(t){var n=D.prototype.search.call(this,this.toBBox(t));return _t(n)},e.collides=function(t){return D.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=D.prototype.all.call(this);return _t(t)},e.toJSON=function(){return D.prototype.toJSON.call(this)},e.fromJSON=function(t){return D.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var n;if(t.bbox)n=t.bbox;else if(Array.isArray(t)&&t.length===4)n=t;else if(Array.isArray(t)&&t.length===6)n=[t[0],t[1],t[3],t[4]];else if(t.type==="Feature")n=ie(t);else if(t.type==="FeatureCollection")n=ie(t);else throw new Error("invalid geojson");return{minX:n[0],minY:n[1],maxX:n[2],maxY:n[3]}},e}Je.exports=qt;Je.exports.default=qt;var $n=Je.exports;const Gn=Wt($n);function qn(r,e){var t={},n=[];if(r.type==="LineString"&&(r=X(r)),e.type==="LineString"&&(e=X(e)),r.type==="Feature"&&e.type==="Feature"&&r.geometry!==null&&e.geometry!==null&&r.geometry.type==="LineString"&&e.geometry.type==="LineString"&&r.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var i=Mt(r,e);return i&&n.push(i),ee(n)}var o=Gn();return o.load(St(e)),Se(St(r),function(s){Se(o.search(s),function(a){var l=Mt(s,a);if(l){var u=q(l).join(",");t[u]||(t[u]=!0,n.push(l))}})}),ee(n)}function Mt(r,e){var t=q(r),n=q(e);if(t.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(n.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var i=t[0][0],o=t[0][1],s=t[1][0],a=t[1][1],l=n[0][0],u=n[0][1],d=n[1][0],f=n[1][1],g=(f-u)*(s-i)-(d-l)*(a-o),y=(d-l)*(o-u)-(f-u)*(i-l),p=(s-i)*(o-u)-(a-o)*(i-l);if(g===0)return null;var w=y/g,M=p/g;if(w>=0&&w<=1&&M>=0&&M<=1){var _=i+w*(s-i),c=o+w*(a-o);return O([_,c])}return null}function Pt(r,e,t){t===void 0&&(t={});var n=O([1/0,1/0],{dist:1/0}),i=0;return fe(r,function(o){for(var s=q(o),a=0;a<s.length-1;a++){var l=O(s[a]);l.properties.dist=j(e,l,t);var u=O(s[a+1]);u.properties.dist=j(e,u,t);var d=j(l,u,t),f=Math.max(l.properties.dist,u.properties.dist),g=Qe(l,u),y=Fe(e,f,g+90,t),p=Fe(e,f,g-90,t),w=qn(F([y.geometry.coordinates,p.geometry.coordinates]),F([l.geometry.coordinates,u.geometry.coordinates])),M=null;w.features.length>0&&(M=w.features[0],M.properties.dist=j(e,M,t),M.properties.location=i+j(l,M,t)),l.properties.dist<n.properties.dist&&(n=l,n.properties.index=a,n.properties.location=i),u.properties.dist<n.properties.dist&&(n=u,n.properties.index=a+1,n.properties.location=i+d),M&&M.properties.dist<n.properties.dist&&(n=M,n.properties.index=a),i+=d}}),n}function fi(r,e,t){var n=q(t);if(Nt(t)!=="LineString")throw new Error("line must be a LineString");var i=Pt(t,r),o=Pt(t,e),s;i.properties.index<=o.properties.index?s=[i,o]:s=[o,i];for(var a=[s[0].geometry.coordinates],l=s[0].properties.index+1;l<s[1].properties.index+1;l++)a.push(n[l]);return a.push(s[1].geometry.coordinates),F(a,t.properties)}function Dn(r,e){if(!r)throw new Error("geojson is required");var t=Nt(r),n=[];switch(t){case"LineString":n=Be(r);break;case"MultiLineString":case"Polygon":q(r).forEach(function(o){n.push(Be(o))});break;case"MultiPolygon":q(r).forEach(function(o){var s=[];o.forEach(function(a){s.push(Be(a))}),n.push(s)});break;case"Point":return r;case"MultiPoint":var i={};q(r).forEach(function(o){var s=o.join("-");Object.prototype.hasOwnProperty.call(i,s)||(n.push(o),i[s]=!0)});break;default:throw new Error(t+" geometry not supported")}return r.coordinates?(r.coordinates=n,r):(r.geometry.coordinates=n,r)}function Be(r){var e=q(r);if(e.length===2&&!Lt(e[0],e[1]))return e;var t=[],n=e.length-1,i=t.length;t.push(e[0]);for(var o=1;o<n;o++){var s=t[t.length-1];e[o][0]===s[0]&&e[o][1]===s[1]||(t.push(e[o]),i=t.length,i>2&&Rt(t[i-3],t[i-1],t[i-2])&&t.splice(t.length-2,1))}if(t.push(e[e.length-1]),i=t.length,Lt(e[0],e[e.length-1])&&i<4)throw new Error("invalid polygon");return Rt(t[i-3],t[i-1],t[i-2])&&t.splice(t.length-2,1),t}function Lt(r,e){return r[0]===e[0]&&r[1]===e[1]}function Rt(r,e,t){var n=t[0],i=t[1],o=r[0],s=r[1],a=e[0],l=e[1],u=n-o,d=i-s,f=a-o,g=l-s,y=u*g-d*f;return y!==0?!1:Math.abs(f)>=Math.abs(g)?f>0?o<=n&&n<=a:a<=n&&n<=o:g>0?s<=i&&i<=l:l<=i&&i<=s}function Un(r){if(!r)throw new Error("geojson is required");switch(r.type){case"Feature":return Dt(r);case"FeatureCollection":return Vn(r);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Ke(r);default:throw new Error("unknown GeoJSON type")}}function Dt(r){var e={type:"Feature"};return Object.keys(r).forEach(function(t){switch(t){case"type":case"properties":case"geometry":return;default:e[t]=r[t]}}),e.properties=Ut(r.properties),e.geometry=Ke(r.geometry),e}function Ut(r){var e={};return r&&Object.keys(r).forEach(function(t){var n=r[t];typeof n=="object"?n===null?e[t]=null:Array.isArray(n)?e[t]=n.map(function(i){return i}):e[t]=Ut(n):e[t]=n}),e}function Vn(r){var e={type:"FeatureCollection"};return Object.keys(r).forEach(function(t){switch(t){case"type":case"features":return;default:e[t]=r[t]}}),e.features=r.features.map(function(t){return Dt(t)}),e}function Ke(r){var e={type:r.type};return r.bbox&&(e.bbox=r.bbox),r.type==="GeometryCollection"?(e.geometries=r.geometries.map(function(t){return Ke(t)}),e):(e.coordinates=Vt(r.coordinates),e)}function Vt(r){var e=r;return typeof e[0]!="object"?e.slice():e.map(function(t){return Vt(t)})}function Zn(r,e){var t=r.x-e.x,n=r.y-e.y;return t*t+n*n}function Hn(r,e,t){var n=e.x,i=e.y,o=t.x-n,s=t.y-i;if(o!==0||s!==0){var a=((r.x-n)*o+(r.y-i)*s)/(o*o+s*s);a>1?(n=t.x,i=t.y):a>0&&(n+=o*a,i+=s*a)}return o=r.x-n,s=r.y-i,o*o+s*s}function Qn(r,e){for(var t=r[0],n=[t],i,o=1,s=r.length;o<s;o++)i=r[o],Zn(i,t)>e&&(n.push(i),t=i);return t!==i&&n.push(i),n}function qe(r,e,t,n,i){for(var o=n,s,a=e+1;a<t;a++){var l=Hn(r[a],r[e],r[t]);l>o&&(s=a,o=l)}o>n&&(s-e>1&&qe(r,e,s,n,i),i.push(r[s]),t-s>1&&qe(r,s,t,n,i))}function Wn(r,e){var t=r.length-1,n=[r[0]];return qe(r,0,t,e,n),n.push(r[t]),n}function De(r,e,t){if(r.length<=2)return r;var n=e!==void 0?e*e:1;return r=t?r:Qn(r,n),r=Wn(r,n),r}function ci(r,e){if(e=e||{},!Ce(e))throw new Error("options is invalid");var t=e.tolerance!==void 0?e.tolerance:1,n=e.highQuality||!1,i=e.mutate||!1;if(!r)throw new Error("geojson is required");if(t&&t<0)throw new Error("invalid tolerance");return i!==!0&&(r=Un(r)),ke(r,function(o){Jn(o,t,n)}),r}function Jn(r,e,t){var n=r.type;if(n==="Point"||n==="MultiPoint")return r;Dn(r);var i=r.coordinates;switch(n){case"LineString":r.coordinates=Ct(i,e,t);break;case"MultiLineString":r.coordinates=i.map(function(o){return Ct(o,e,t)});break;case"Polygon":r.coordinates=kt(i,e,t);break;case"MultiPolygon":r.coordinates=i.map(function(o){return kt(o,e,t)})}return r}function Ct(r,e,t){return De(r.map(function(n){return{x:n[0],y:n[1],z:n[2]}}),e,t).map(function(n){return n.z?[n.x,n.y,n.z]:[n.x,n.y]})}function kt(r,e,t){return r.map(function(n){var i=n.map(function(s){return{x:s[0],y:s[1]}});if(i.length<4)throw new Error("invalid polygon");for(var o=De(i,e,t).map(function(s){return[s.x,s.y]});!Kn(o);)e-=e*.01,o=De(i,e,t).map(function(s){return[s.x,s.y]});return(o[o.length-1][0]!==o[0][0]||o[o.length-1][1]!==o[0][1])&&o.push(o[0]),o})}function Kn(r){return r.length<3?!1:!(r.length===3&&r[2][0]===r[0][0]&&r[2][1]===r[0][1])}function hi(r,e){e===void 0&&(e={});var t=_e(r),n=(t[0]+t[2])/2,i=(t[1]+t[3])/2;return O([n,i],e.properties,e)}export{ni as L,ri as M,ii as S,oi as a,_e as b,si as c,j as d,ai as e,ee as f,qn as g,fi as h,li as i,F as j,hi as k,ui as l,Fe as m,ve as n,Qe as o,O as p,ci as s};
